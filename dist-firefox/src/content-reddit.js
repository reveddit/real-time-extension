(()=>{var e={3150:function(e,r){var s,g,a;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,g=[e],s=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const r="The message port closed before a response was received.",s=e=>{const s={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(s).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class g extends WeakMap{constructor(e,r=void 0){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=e=>e&&"object"==typeof e&&"function"==typeof e.then,m=(r,s)=>(...g)=>{e.runtime.lastError?r.reject(new Error(e.runtime.lastError.message)):s.singleCallbackArg||g.length<=1&&!1!==s.singleCallbackArg?r.resolve(g[0]):r.resolve(g)},n=e=>1==e?"argument":"arguments",t=(e,r)=>function(s,...g){if(g.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${n(r.minArgs)} for ${e}(), got ${g.length}`);if(g.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${n(r.maxArgs)} for ${e}(), got ${g.length}`);return new Promise(((a,n)=>{if(r.fallbackToNoCallback)try{s[e](...g,m({resolve:a,reject:n},r))}catch(m){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,m),s[e](...g),r.fallbackToNoCallback=!1,r.noCallback=!0,a()}else r.noCallback?(s[e](...g),a()):s[e](...g,m({resolve:a,reject:n},r))}))},A=(e,r,s)=>new Proxy(r,{apply:(r,g,a)=>s.call(g,e,...a)});let i=Function.call.bind(Object.prototype.hasOwnProperty);const o=(e,r={},s={})=>{let g=Object.create(null),a={has:(r,s)=>s in e||s in g,get(a,m,n){if(m in g)return g[m];if(!(m in e))return;let l=e[m];if("function"==typeof l)if("function"==typeof r[m])l=A(e,e[m],r[m]);else if(i(s,m)){let r=t(m,s[m]);l=A(e,e[m],r)}else l=l.bind(e);else if("object"==typeof l&&null!==l&&(i(r,m)||i(s,m)))l=o(l,r[m],s[m]);else{if(!i(s,"*"))return Object.defineProperty(g,m,{configurable:!0,enumerable:!0,get:()=>e[m],set(r){e[m]=r}}),l;l=o(l,r[m],s["*"])}return g[m]=l,l},set:(r,s,a,m)=>(s in g?g[s]=a:e[s]=a,!0),defineProperty:(e,r,s)=>Reflect.defineProperty(g,r,s),deleteProperty:(e,r)=>Reflect.deleteProperty(g,r)},m=Object.create(e);return new Proxy(m,a)},l=e=>({addListener(r,s,...g){r.addListener(e.get(s),...g)},hasListener:(r,s)=>r.hasListener(e.get(s)),removeListener(r,s){r.removeListener(e.get(s))}}),c=new g((e=>"function"!=typeof e?e:function(r){const s=o(r,{},{getContent:{minArgs:0,maxArgs:0}});e(s)})),x=new g((e=>"function"!=typeof e?e:function(r,s,g){let m,n,t=!1,A=new Promise((e=>{m=function(r){t=!0,e(r)}}));try{n=e(r,s,m)}catch(e){n=Promise.reject(e)}const i=!0!==n&&a(n);if(!0!==n&&!i&&!t)return!1;const o=e=>{e.then((e=>{g(e)}),(e=>{let r;r=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",g({__mozWebExtensionPolyfillReject__:!0,message:r})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return o(i?n:A),!0})),d=({reject:s,resolve:g},a)=>{e.runtime.lastError?e.runtime.lastError.message===r?g():s(new Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?s(new Error(a.message)):g(a)},u=(e,r,s,...g)=>{if(g.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${n(r.minArgs)} for ${e}(), got ${g.length}`);if(g.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${n(r.maxArgs)} for ${e}(), got ${g.length}`);return new Promise(((e,r)=>{const a=d.bind(null,{resolve:e,reject:r});g.push(a),s.sendMessage(...g)}))},b={devtools:{network:{onRequestFinished:l(c)}},runtime:{onMessage:l(x),onMessageExternal:l(x),sendMessage:u.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:u.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return s.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},o(e,b,s)};e.exports=s(chrome)}else e.exports=globalThis.browser},void 0===(a="function"==typeof s?s.apply(r,g):s)||(e.exports=a)},6086:(e,r,s)=>{"use strict";s(3368),s(3150)},6216:(e,r,s)=>{"use strict";s(3368),s(6086),s(97),s(3150);Math.floor(60*Math.random());location.hostname.match(/reveddit\.com$/)&&"unsubscribe"},97:(e,r,s)=>{"use strict";s(3368),s(3150)},3368:(e,r,s)=>{"use strict";s(6086),s(3150)}},r={};function s(g){var a=r[g];if(void 0!==a)return a.exports;var m=r[g]={exports:{}};return e[g].call(m.exports,m,m.exports,s),m.exports}s.d=(e,r)=>{for(var g in r)s.o(r,g)&&!s.o(e,g)&&Object.defineProperty(e,g,{enumerable:!0,get:r[g]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";s(97),s(6086),s(6216),s(3150),s(3368);"Comment removed by moderator".toLowerCase().trim()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzVCLE1BQ0VELEVBQU8wSCxRQUFVNUgsV0FBV08sT0FFaEMsT0FqdkN1RCwwRCx5R0NhRXNILEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQ1ByRUMsU0FBU0MsU0FBU0MsTUFBTSxtQkFDTCxhLDJGQ1JuQkMsRUFBMkIsQ0FBQyxFQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCL0csSUFBakJnSCxFQUNILE9BQU9BLEVBQWFWLFFBR3JCLElBQUkxSCxFQUFTaUksRUFBeUJFLEdBQVksQ0FHakRULFFBQVMsQ0FBQyxHQU9YLE9BSEFXLEVBQW9CRixHQUFVdkUsS0FBSzVELEVBQU8wSCxRQUFTMUgsRUFBUUEsRUFBTzBILFFBQVNRLEdBR3BFbEksRUFBTzBILE9BQ2YsQ0NyQkFRLEVBQW9CSSxFQUFJLENBQUNaLEVBQVNhLEtBQ2pDLElBQUksSUFBSS9HLEtBQU8rRyxFQUNYTCxFQUFvQk0sRUFBRUQsRUFBWS9HLEtBQVMwRyxFQUFvQk0sRUFBRWQsRUFBU2xHLElBQzVFbEIsT0FBT2tFLGVBQWVrRCxFQUFTbEcsRUFBSyxDQUFFa0QsWUFBWSxFQUFNbkQsSUFBS2dILEVBQVcvRyxJQUUxRSxFQ05EMEcsRUFBb0JNLEVBQUksQ0FBQ0MsRUFBS25FLElBQVVoRSxPQUFPRSxVQUFVcUQsZUFBZUQsS0FBSzZFLEVBQUtuRSxHLHlEQzREbkQsK0JBQStCb0UsY0FBY0MsTSIsInNvdXJjZXMiOlsid2VicGFjazovL3JldmVkZGl0X3JlYWxfdGltZS8uL25vZGVfbW9kdWxlcy93ZWJleHRlbnNpb24tcG9seWZpbGwvZGlzdC9icm93c2VyLXBvbHlmaWxsLmpzIiwid2VicGFjazovL3JldmVkZGl0X3JlYWxfdGltZS8uL3NyYy9zcmMvbW9uaXRvcmluZy5qcyIsIndlYnBhY2s6Ly9yZXZlZGRpdF9yZWFsX3RpbWUvLi9zcmMvc3JjL2NvbnRlbnQtY29tbW9uLmpzIiwid2VicGFjazovL3JldmVkZGl0X3JlYWxfdGltZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9yZXZlZGRpdF9yZWFsX3RpbWUvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3JldmVkZGl0X3JlYWxfdGltZS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3JldmVkZGl0X3JlYWxfdGltZS8uL3NyYy9zcmMvY29udGVudC1yZWRkaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsXCIsIFtcIm1vZHVsZVwiXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBmYWN0b3J5KG1vZHVsZSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIG1vZCA9IHtcbiAgICAgIGV4cG9ydHM6IHt9XG4gICAgfTtcbiAgICBmYWN0b3J5KG1vZCk7XG4gICAgZ2xvYmFsLmJyb3dzZXIgPSBtb2QuZXhwb3J0cztcbiAgfVxufSkodHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24gKG1vZHVsZSkge1xuICAvKiB3ZWJleHRlbnNpb24tcG9seWZpbGwgLSB2MC4xMC4wIC0gRnJpIEF1ZyAxMiAyMDIyIDE5OjQyOjQ0ICovXG5cbiAgLyogLSotIE1vZGU6IGluZGVudC10YWJzLW1vZGU6IG5pbDsganMtaW5kZW50LWxldmVsOiAyIC0qLSAqL1xuXG4gIC8qIHZpbTogc2V0IHN0cz0yIHN3PTIgZXQgdHc9ODA6ICovXG5cbiAgLyogVGhpcyBTb3VyY2UgQ29kZSBGb3JtIGlzIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNb3ppbGxhIFB1YmxpY1xuICAgKiBMaWNlbnNlLCB2LiAyLjAuIElmIGEgY29weSBvZiB0aGUgTVBMIHdhcyBub3QgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzXG4gICAqIGZpbGUsIFlvdSBjYW4gb2J0YWluIG9uZSBhdCBodHRwOi8vbW96aWxsYS5vcmcvTVBMLzIuMC8uICovXG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIGlmICghZ2xvYmFsVGhpcy5jaHJvbWU/LnJ1bnRpbWU/LmlkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBzY3JpcHQgc2hvdWxkIG9ubHkgYmUgbG9hZGVkIGluIGEgYnJvd3NlciBleHRlbnNpb24uXCIpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzLmJyb3dzZXIgPT09IFwidW5kZWZpbmVkXCIgfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbFRoaXMuYnJvd3NlcikgIT09IE9iamVjdC5wcm90b3R5cGUpIHtcbiAgICBjb25zdCBDSFJPTUVfU0VORF9NRVNTQUdFX0NBTExCQUNLX05PX1JFU1BPTlNFX01FU1NBR0UgPSBcIlRoZSBtZXNzYWdlIHBvcnQgY2xvc2VkIGJlZm9yZSBhIHJlc3BvbnNlIHdhcyByZWNlaXZlZC5cIjsgLy8gV3JhcHBpbmcgdGhlIGJ1bGsgb2YgdGhpcyBwb2x5ZmlsbCBpbiBhIG9uZS10aW1lLXVzZSBmdW5jdGlvbiBpcyBhIG1pbm9yXG4gICAgLy8gb3B0aW1pemF0aW9uIGZvciBGaXJlZm94LiBTaW5jZSBTcGlkZXJtb25rZXkgZG9lcyBub3QgZnVsbHkgcGFyc2UgdGhlXG4gICAgLy8gY29udGVudHMgb2YgYSBmdW5jdGlvbiB1bnRpbCB0aGUgZmlyc3QgdGltZSBpdCdzIGNhbGxlZCwgYW5kIHNpbmNlIGl0IHdpbGxcbiAgICAvLyBuZXZlciBhY3R1YWxseSBuZWVkIHRvIGJlIGNhbGxlZCwgdGhpcyBhbGxvd3MgdGhlIHBvbHlmaWxsIHRvIGJlIGluY2x1ZGVkXG4gICAgLy8gaW4gRmlyZWZveCBuZWFybHkgZm9yIGZyZWUuXG5cbiAgICBjb25zdCB3cmFwQVBJcyA9IGV4dGVuc2lvbkFQSXMgPT4ge1xuICAgICAgLy8gTk9URTogYXBpTWV0YWRhdGEgaXMgYXNzb2NpYXRlZCB0byB0aGUgY29udGVudCBvZiB0aGUgYXBpLW1ldGFkYXRhLmpzb24gZmlsZVxuICAgICAgLy8gYXQgYnVpbGQgdGltZSBieSByZXBsYWNpbmcgdGhlIGZvbGxvd2luZyBcImluY2x1ZGVcIiB3aXRoIHRoZSBjb250ZW50IG9mIHRoZVxuICAgICAgLy8gSlNPTiBmaWxlLlxuICAgICAgY29uc3QgYXBpTWV0YWRhdGEgPSB7XG4gICAgICAgIFwiYWxhcm1zXCI6IHtcbiAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY2xlYXJBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJib29rbWFya3NcIjoge1xuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Q2hpbGRyZW5cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRSZWNlbnRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRTdWJUcmVlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VHJlZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVUcmVlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VhcmNoXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiYnJvd3NlckFjdGlvblwiOiB7XG4gICAgICAgICAgXCJkaXNhYmxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZW5hYmxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3JcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRCYWRnZVRleHRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwib3BlblBvcHVwXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3JcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRCYWRnZVRleHRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRJY29uXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0UG9wdXBcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRUaXRsZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImJyb3dzaW5nRGF0YVwiOiB7XG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVDYWNoZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUNvb2tpZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVEb3dubG9hZHNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVGb3JtRGF0YVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUhpc3RvcnlcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVMb2NhbFN0b3JhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVQYXNzd29yZHNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVQbHVnaW5EYXRhXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0dGluZ3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJjb21tYW5kc1wiOiB7XG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJjb250ZXh0TWVudXNcIjoge1xuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlQWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiY29va2llc1wiOiB7XG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxDb29raWVTdG9yZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJkZXZ0b29sc1wiOiB7XG4gICAgICAgICAgXCJpbnNwZWN0ZWRXaW5kb3dcIjoge1xuICAgICAgICAgICAgXCJldmFsXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyLFxuICAgICAgICAgICAgICBcInNpbmdsZUNhbGxiYWNrQXJnXCI6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInBhbmVsc1wiOiB7XG4gICAgICAgICAgICBcImNyZWF0ZVwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAzLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMyxcbiAgICAgICAgICAgICAgXCJzaW5nbGVDYWxsYmFja0FyZ1wiOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJlbGVtZW50c1wiOiB7XG4gICAgICAgICAgICAgIFwiY3JlYXRlU2lkZWJhclBhbmVcIjoge1xuICAgICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiZG93bmxvYWRzXCI6IHtcbiAgICAgICAgICBcImNhbmNlbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRvd25sb2FkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZXJhc2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRGaWxlSWNvblwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm9wZW5cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJwYXVzZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUZpbGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXN1bWVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZWFyY2hcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzaG93XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiZXh0ZW5zaW9uXCI6IHtcbiAgICAgICAgICBcImlzQWxsb3dlZEZpbGVTY2hlbWVBY2Nlc3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJpc0FsbG93ZWRJbmNvZ25pdG9BY2Nlc3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJoaXN0b3J5XCI6IHtcbiAgICAgICAgICBcImFkZFVybFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRlbGV0ZUFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRlbGV0ZVJhbmdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGVsZXRlVXJsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VmlzaXRzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VhcmNoXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgXCJkZXRlY3RMYW5ndWFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFjY2VwdExhbmd1YWdlc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImlkZW50aXR5XCI6IHtcbiAgICAgICAgICBcImxhdW5jaFdlYkF1dGhGbG93XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiaWRsZVwiOiB7XG4gICAgICAgICAgXCJxdWVyeVN0YXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwibWFuYWdlbWVudFwiOiB7XG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRTZWxmXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0RW5hYmxlZFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInVuaW5zdGFsbFNlbGZcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJub3RpZmljYXRpb25zXCI6IHtcbiAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0UGVybWlzc2lvbkxldmVsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwicGFnZUFjdGlvblwiOiB7XG4gICAgICAgICAgXCJnZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaGlkZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldEljb25cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2hvd1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInBlcm1pc3Npb25zXCI6IHtcbiAgICAgICAgICBcImNvbnRhaW5zXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVxdWVzdFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInJ1bnRpbWVcIjoge1xuICAgICAgICAgIFwiZ2V0QmFja2dyb3VuZFBhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRQbGF0Zm9ybUluZm9cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJvcGVuT3B0aW9uc1BhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXF1ZXN0VXBkYXRlQ2hlY2tcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZW5kTWVzc2FnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAzXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNlbmROYXRpdmVNZXNzYWdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0VW5pbnN0YWxsVVJMXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwic2Vzc2lvbnNcIjoge1xuICAgICAgICAgIFwiZ2V0RGV2aWNlc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFJlY2VudGx5Q2xvc2VkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVzdG9yZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInN0b3JhZ2VcIjoge1xuICAgICAgICAgIFwibG9jYWxcIjoge1xuICAgICAgICAgICAgXCJjbGVhclwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInNldFwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJtYW5hZ2VkXCI6IHtcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInN5bmNcIjoge1xuICAgICAgICAgICAgXCJjbGVhclwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInNldFwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJ0YWJzXCI6IHtcbiAgICAgICAgICBcImNhcHR1cmVWaXNpYmxlVGFiXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGV0ZWN0TGFuZ3VhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJkaXNjYXJkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZHVwbGljYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZXhlY3V0ZVNjcmlwdFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEN1cnJlbnRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRab29tXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Wm9vbVNldHRpbmdzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ29CYWNrXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ29Gb3J3YXJkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaGlnaGxpZ2h0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaW5zZXJ0Q1NTXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwibW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInF1ZXJ5XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVsb2FkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlQ1NTXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VuZE1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogM1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRab29tXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0Wm9vbVNldHRpbmdzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwidG9wU2l0ZXNcIjoge1xuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwid2ViTmF2aWdhdGlvblwiOiB7XG4gICAgICAgICAgXCJnZXRBbGxGcmFtZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRGcmFtZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIndlYlJlcXVlc3RcIjoge1xuICAgICAgICAgIFwiaGFuZGxlckJlaGF2aW9yQ2hhbmdlZFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIndpbmRvd3NcIjoge1xuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Q3VycmVudFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldExhc3RGb2N1c2VkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhhcGlNZXRhZGF0YSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImFwaS1tZXRhZGF0YS5qc29uIGhhcyBub3QgYmVlbiBpbmNsdWRlZCBpbiBicm93c2VyLXBvbHlmaWxsXCIpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBBIFdlYWtNYXAgc3ViY2xhc3Mgd2hpY2ggY3JlYXRlcyBhbmQgc3RvcmVzIGEgdmFsdWUgZm9yIGFueSBrZXkgd2hpY2ggZG9lc1xuICAgICAgICogbm90IGV4aXN0IHdoZW4gYWNjZXNzZWQsIGJ1dCBiZWhhdmVzIGV4YWN0bHkgYXMgYW4gb3JkaW5hcnkgV2Vha01hcFxuICAgICAgICogb3RoZXJ3aXNlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNyZWF0ZUl0ZW1cbiAgICAgICAqICAgICAgICBBIGZ1bmN0aW9uIHdoaWNoIHdpbGwgYmUgY2FsbGVkIGluIG9yZGVyIHRvIGNyZWF0ZSB0aGUgdmFsdWUgZm9yIGFueVxuICAgICAgICogICAgICAgIGtleSB3aGljaCBkb2VzIG5vdCBleGlzdCwgdGhlIGZpcnN0IHRpbWUgaXQgaXMgYWNjZXNzZWQuIFRoZVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uIHJlY2VpdmVzLCBhcyBpdHMgb25seSBhcmd1bWVudCwgdGhlIGtleSBiZWluZyBjcmVhdGVkLlxuICAgICAgICovXG5cblxuICAgICAgY2xhc3MgRGVmYXVsdFdlYWtNYXAgZXh0ZW5kcyBXZWFrTWFwIHtcbiAgICAgICAgY29uc3RydWN0b3IoY3JlYXRlSXRlbSwgaXRlbXMgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBzdXBlcihpdGVtcyk7XG4gICAgICAgICAgdGhpcy5jcmVhdGVJdGVtID0gY3JlYXRlSXRlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldChrZXkpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KGtleSwgdGhpcy5jcmVhdGVJdGVtKGtleSkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBzdXBlci5nZXQoa2V5KTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGFuIG9iamVjdCB3aXRoIGEgYHRoZW5gIG1ldGhvZCwgYW5kIGNhblxuICAgICAgICogdGhlcmVmb3JlIGJlIGFzc3VtZWQgdG8gYmVoYXZlIGFzIGEgUHJvbWlzZS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0LlxuICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHZhbHVlIGlzIHRoZW5hYmxlLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3QgaXNUaGVuYWJsZSA9IHZhbHVlID0+IHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIHdoaWNoLCB3aGVuIGNhbGxlZCwgd2lsbCByZXNvbHZlIG9yIHJlamVjdFxuICAgICAgICogdGhlIGdpdmVuIHByb21pc2UgYmFzZWQgb24gaG93IGl0IGlzIGNhbGxlZDpcbiAgICAgICAqXG4gICAgICAgKiAtIElmLCB3aGVuIGNhbGxlZCwgYGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcmAgY29udGFpbnMgYSBub24tbnVsbCBvYmplY3QsXG4gICAgICAgKiAgIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIHdpdGggdGhhdCB2YWx1ZS5cbiAgICAgICAqIC0gSWYgdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aXRoIGV4YWN0bHkgb25lIGFyZ3VtZW50LCB0aGUgcHJvbWlzZSBpc1xuICAgICAgICogICByZXNvbHZlZCB0byB0aGF0IHZhbHVlLlxuICAgICAgICogLSBPdGhlcndpc2UsIHRoZSBwcm9taXNlIGlzIHJlc29sdmVkIHRvIGFuIGFycmF5IGNvbnRhaW5pbmcgYWxsIG9mIHRoZVxuICAgICAgICogICBmdW5jdGlvbidzIGFyZ3VtZW50cy5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gcHJvbWlzZVxuICAgICAgICogICAgICAgIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSByZXNvbHV0aW9uIGFuZCByZWplY3Rpb24gZnVuY3Rpb25zIG9mIGFcbiAgICAgICAqICAgICAgICBwcm9taXNlLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcHJvbWlzZS5yZXNvbHZlXG4gICAgICAgKiAgICAgICAgVGhlIHByb21pc2UncyByZXNvbHV0aW9uIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcHJvbWlzZS5yZWplY3RcbiAgICAgICAqICAgICAgICBUaGUgcHJvbWlzZSdzIHJlamVjdGlvbiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtZXRhZGF0YVxuICAgICAgICogICAgICAgIE1ldGFkYXRhIGFib3V0IHRoZSB3cmFwcGVkIG1ldGhvZCB3aGljaCBoYXMgY3JlYXRlZCB0aGUgY2FsbGJhY2suXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG1ldGFkYXRhLnNpbmdsZUNhbGxiYWNrQXJnXG4gICAgICAgKiAgICAgICAgV2hldGhlciBvciBub3QgdGhlIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCBvbmx5IHRoZSBmaXJzdFxuICAgICAgICogICAgICAgIGFyZ3VtZW50IG9mIHRoZSBjYWxsYmFjaywgYWx0ZXJuYXRpdmVseSBhbiBhcnJheSBvZiBhbGwgdGhlXG4gICAgICAgKiAgICAgICAgY2FsbGJhY2sgYXJndW1lbnRzIGlzIHJlc29sdmVkLiBCeSBkZWZhdWx0LCBpZiB0aGUgY2FsbGJhY2tcbiAgICAgICAqICAgICAgICBmdW5jdGlvbiBpcyBpbnZva2VkIHdpdGggb25seSBhIHNpbmdsZSBhcmd1bWVudCwgdGhhdCB3aWxsIGJlXG4gICAgICAgKiAgICAgICAgcmVzb2x2ZWQgdG8gdGhlIHByb21pc2UsIHdoaWxlIGFsbCBhcmd1bWVudHMgd2lsbCBiZSByZXNvbHZlZCBhc1xuICAgICAgICogICAgICAgIGFuIGFycmF5IGlmIG11bHRpcGxlIGFyZSBnaXZlbi5cbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259XG4gICAgICAgKiAgICAgICAgVGhlIGdlbmVyYXRlZCBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgICAqL1xuXG5cbiAgICAgIGNvbnN0IG1ha2VDYWxsYmFjayA9IChwcm9taXNlLCBtZXRhZGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gKC4uLmNhbGxiYWNrQXJncykgPT4ge1xuICAgICAgICAgIGlmIChleHRlbnNpb25BUElzLnJ1bnRpbWUubGFzdEVycm9yKSB7XG4gICAgICAgICAgICBwcm9taXNlLnJlamVjdChuZXcgRXJyb3IoZXh0ZW5zaW9uQVBJcy5ydW50aW1lLmxhc3RFcnJvci5tZXNzYWdlKSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRhZGF0YS5zaW5nbGVDYWxsYmFja0FyZyB8fCBjYWxsYmFja0FyZ3MubGVuZ3RoIDw9IDEgJiYgbWV0YWRhdGEuc2luZ2xlQ2FsbGJhY2tBcmcgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICBwcm9taXNlLnJlc29sdmUoY2FsbGJhY2tBcmdzWzBdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZS5yZXNvbHZlKGNhbGxiYWNrQXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcGx1cmFsaXplQXJndW1lbnRzID0gbnVtQXJncyA9PiBudW1BcmdzID09IDEgPyBcImFyZ3VtZW50XCIgOiBcImFyZ3VtZW50c1wiO1xuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGEgd3JhcHBlciBmdW5jdGlvbiBmb3IgYSBtZXRob2Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZSBhbmQgbWV0YWRhdGEuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICAgICAqICAgICAgICBUaGUgbmFtZSBvZiB0aGUgbWV0aG9kIHdoaWNoIGlzIGJlaW5nIHdyYXBwZWQuXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gbWV0YWRhdGFcbiAgICAgICAqICAgICAgICBNZXRhZGF0YSBhYm91dCB0aGUgbWV0aG9kIGJlaW5nIHdyYXBwZWQuXG4gICAgICAgKiBAcGFyYW0ge2ludGVnZXJ9IG1ldGFkYXRhLm1pbkFyZ3NcbiAgICAgICAqICAgICAgICBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHdoaWNoIG11c3QgYmUgcGFzc2VkIHRvIHRoZVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uLiBJZiBjYWxsZWQgd2l0aCBmZXdlciB0aGFuIHRoaXMgbnVtYmVyIG9mIGFyZ3VtZW50cywgdGhlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciB3aWxsIHJhaXNlIGFuIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7aW50ZWdlcn0gbWV0YWRhdGEubWF4QXJnc1xuICAgICAgICogICAgICAgIFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVudHMgd2hpY2ggbWF5IGJlIHBhc3NlZCB0byB0aGVcbiAgICAgICAqICAgICAgICBmdW5jdGlvbi4gSWYgY2FsbGVkIHdpdGggbW9yZSB0aGFuIHRoaXMgbnVtYmVyIG9mIGFyZ3VtZW50cywgdGhlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciB3aWxsIHJhaXNlIGFuIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbWV0YWRhdGEuc2luZ2xlQ2FsbGJhY2tBcmdcbiAgICAgICAqICAgICAgICBXaGV0aGVyIG9yIG5vdCB0aGUgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIG9ubHkgdGhlIGZpcnN0XG4gICAgICAgKiAgICAgICAgYXJndW1lbnQgb2YgdGhlIGNhbGxiYWNrLCBhbHRlcm5hdGl2ZWx5IGFuIGFycmF5IG9mIGFsbCB0aGVcbiAgICAgICAqICAgICAgICBjYWxsYmFjayBhcmd1bWVudHMgaXMgcmVzb2x2ZWQuIEJ5IGRlZmF1bHQsIGlmIHRoZSBjYWxsYmFja1xuICAgICAgICogICAgICAgIGZ1bmN0aW9uIGlzIGludm9rZWQgd2l0aCBvbmx5IGEgc2luZ2xlIGFyZ3VtZW50LCB0aGF0IHdpbGwgYmVcbiAgICAgICAqICAgICAgICByZXNvbHZlZCB0byB0aGUgcHJvbWlzZSwgd2hpbGUgYWxsIGFyZ3VtZW50cyB3aWxsIGJlIHJlc29sdmVkIGFzXG4gICAgICAgKiAgICAgICAgYW4gYXJyYXkgaWYgbXVsdGlwbGUgYXJlIGdpdmVuLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihvYmplY3QsIC4uLiopfVxuICAgICAgICogICAgICAgVGhlIGdlbmVyYXRlZCB3cmFwcGVyIGZ1bmN0aW9uLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3Qgd3JhcEFzeW5jRnVuY3Rpb24gPSAobmFtZSwgbWV0YWRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGFzeW5jRnVuY3Rpb25XcmFwcGVyKHRhcmdldCwgLi4uYXJncykge1xuICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IG1ldGFkYXRhLm1pbkFyZ3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgYXQgbGVhc3QgJHttZXRhZGF0YS5taW5BcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5taW5BcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gbWV0YWRhdGEubWF4QXJncykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBtb3N0ICR7bWV0YWRhdGEubWF4QXJnc30gJHtwbHVyYWxpemVBcmd1bWVudHMobWV0YWRhdGEubWF4QXJncyl9IGZvciAke25hbWV9KCksIGdvdCAke2FyZ3MubGVuZ3RofWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBpZiAobWV0YWRhdGEuZmFsbGJhY2tUb05vQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgLy8gVGhpcyBBUEkgbWV0aG9kIGhhcyBjdXJyZW50bHkgbm8gY2FsbGJhY2sgb24gQ2hyb21lLCBidXQgaXQgcmV0dXJuIGEgcHJvbWlzZSBvbiBGaXJlZm94LFxuICAgICAgICAgICAgICAvLyBhbmQgc28gdGhlIHBvbHlmaWxsIHdpbGwgdHJ5IHRvIGNhbGwgaXQgd2l0aCBhIGNhbGxiYWNrIGZpcnN0LCBhbmQgaXQgd2lsbCBmYWxsYmFja1xuICAgICAgICAgICAgICAvLyB0byBub3QgcGFzc2luZyB0aGUgY2FsbGJhY2sgaWYgdGhlIGZpcnN0IGNhbGwgZmFpbHMuXG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MsIG1ha2VDYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgICByZXNvbHZlLFxuICAgICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICAgfSwgbWV0YWRhdGEpKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoY2JFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgJHtuYW1lfSBBUEkgbWV0aG9kIGRvZXNuJ3Qgc2VlbSB0byBzdXBwb3J0IHRoZSBjYWxsYmFjayBwYXJhbWV0ZXIsIGAgKyBcImZhbGxpbmcgYmFjayB0byBjYWxsIGl0IHdpdGhvdXQgYSBjYWxsYmFjazogXCIsIGNiRXJyb3IpO1xuICAgICAgICAgICAgICAgIHRhcmdldFtuYW1lXSguLi5hcmdzKTsgLy8gVXBkYXRlIHRoZSBBUEkgbWV0aG9kIG1ldGFkYXRhLCBzbyB0aGF0IHRoZSBuZXh0IEFQSSBjYWxscyB3aWxsIG5vdCB0cnkgdG9cbiAgICAgICAgICAgICAgICAvLyB1c2UgdGhlIHVuc3VwcG9ydGVkIGNhbGxiYWNrIGFueW1vcmUuXG5cbiAgICAgICAgICAgICAgICBtZXRhZGF0YS5mYWxsYmFja1RvTm9DYWxsYmFjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhLm5vQ2FsbGJhY2sgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChtZXRhZGF0YS5ub0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgIHRhcmdldFtuYW1lXSguLi5hcmdzKTtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MsIG1ha2VDYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgfSwgbWV0YWRhdGEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIFdyYXBzIGFuIGV4aXN0aW5nIG1ldGhvZCBvZiB0aGUgdGFyZ2V0IG9iamVjdCwgc28gdGhhdCBjYWxscyB0byBpdCBhcmVcbiAgICAgICAqIGludGVyY2VwdGVkIGJ5IHRoZSBnaXZlbiB3cmFwcGVyIGZ1bmN0aW9uLiBUaGUgd3JhcHBlciBmdW5jdGlvbiByZWNlaXZlcyxcbiAgICAgICAqIGFzIGl0cyBmaXJzdCBhcmd1bWVudCwgdGhlIG9yaWdpbmFsIGB0YXJnZXRgIG9iamVjdCwgZm9sbG93ZWQgYnkgZWFjaCBvZlxuICAgICAgICogdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIG9yaWdpbmFsIG1ldGhvZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0XG4gICAgICAgKiAgICAgICAgVGhlIG9yaWdpbmFsIHRhcmdldCBvYmplY3QgdGhhdCB0aGUgd3JhcHBlZCBtZXRob2QgYmVsb25ncyB0by5cbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1ldGhvZFxuICAgICAgICogICAgICAgIFRoZSBtZXRob2QgYmVpbmcgd3JhcHBlZC4gVGhpcyBpcyB1c2VkIGFzIHRoZSB0YXJnZXQgb2YgdGhlIFByb3h5XG4gICAgICAgKiAgICAgICAgb2JqZWN0IHdoaWNoIGlzIGNyZWF0ZWQgdG8gd3JhcCB0aGUgbWV0aG9kLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gd3JhcHBlclxuICAgICAgICogICAgICAgIFRoZSB3cmFwcGVyIGZ1bmN0aW9uIHdoaWNoIGlzIGNhbGxlZCBpbiBwbGFjZSBvZiBhIGRpcmVjdCBpbnZvY2F0aW9uXG4gICAgICAgKiAgICAgICAgb2YgdGhlIHdyYXBwZWQgbWV0aG9kLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtQcm94eTxmdW5jdGlvbj59XG4gICAgICAgKiAgICAgICAgQSBQcm94eSBvYmplY3QgZm9yIHRoZSBnaXZlbiBtZXRob2QsIHdoaWNoIGludm9rZXMgdGhlIGdpdmVuIHdyYXBwZXJcbiAgICAgICAqICAgICAgICBtZXRob2QgaW4gaXRzIHBsYWNlLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3Qgd3JhcE1ldGhvZCA9ICh0YXJnZXQsIG1ldGhvZCwgd3JhcHBlcikgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KG1ldGhvZCwge1xuICAgICAgICAgIGFwcGx5KHRhcmdldE1ldGhvZCwgdGhpc09iaiwgYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIHdyYXBwZXIuY2FsbCh0aGlzT2JqLCB0YXJnZXQsIC4uLmFyZ3MpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGxldCBoYXNPd25Qcm9wZXJ0eSA9IEZ1bmN0aW9uLmNhbGwuYmluZChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5KTtcbiAgICAgIC8qKlxuICAgICAgICogV3JhcHMgYW4gb2JqZWN0IGluIGEgUHJveHkgd2hpY2ggaW50ZXJjZXB0cyBhbmQgd3JhcHMgY2VydGFpbiBtZXRob2RzXG4gICAgICAgKiBiYXNlZCBvbiB0aGUgZ2l2ZW4gYHdyYXBwZXJzYCBhbmQgYG1ldGFkYXRhYCBvYmplY3RzLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0YXJnZXRcbiAgICAgICAqICAgICAgICBUaGUgdGFyZ2V0IG9iamVjdCB0byB3cmFwLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbd3JhcHBlcnMgPSB7fV1cbiAgICAgICAqICAgICAgICBBbiBvYmplY3QgdHJlZSBjb250YWluaW5nIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBzcGVjaWFsIGNhc2VzLiBBbnlcbiAgICAgICAqICAgICAgICBmdW5jdGlvbiBwcmVzZW50IGluIHRoaXMgb2JqZWN0IHRyZWUgaXMgY2FsbGVkIGluIHBsYWNlIG9mIHRoZVxuICAgICAgICogICAgICAgIG1ldGhvZCBpbiB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgYHRhcmdldGAgb2JqZWN0IHRyZWUuIFRoZXNlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciBtZXRob2RzIGFyZSBpbnZva2VkIGFzIGRlc2NyaWJlZCBpbiB7QHNlZSB3cmFwTWV0aG9kfS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gW21ldGFkYXRhID0ge31dXG4gICAgICAgKiAgICAgICAgQW4gb2JqZWN0IHRyZWUgY29udGFpbmluZyBtZXRhZGF0YSB1c2VkIHRvIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVcbiAgICAgICAqICAgICAgICBQcm9taXNlLWJhc2VkIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBhc3luY2hyb25vdXMuIEFueSBmdW5jdGlvbiBpblxuICAgICAgICogICAgICAgIHRoZSBgdGFyZ2V0YCBvYmplY3QgdHJlZSB3aGljaCBoYXMgYSBjb3JyZXNwb25kaW5nIG1ldGFkYXRhIG9iamVjdFxuICAgICAgICogICAgICAgIGluIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBgbWV0YWRhdGFgIHRyZWUgaXMgcmVwbGFjZWQgd2l0aCBhblxuICAgICAgICogICAgICAgIGF1dG9tYXRpY2FsbHktZ2VuZXJhdGVkIHdyYXBwZXIgZnVuY3Rpb24sIGFzIGRlc2NyaWJlZCBpblxuICAgICAgICogICAgICAgIHtAc2VlIHdyYXBBc3luY0Z1bmN0aW9ufVxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtQcm94eTxvYmplY3Q+fVxuICAgICAgICovXG5cbiAgICAgIGNvbnN0IHdyYXBPYmplY3QgPSAodGFyZ2V0LCB3cmFwcGVycyA9IHt9LCBtZXRhZGF0YSA9IHt9KSA9PiB7XG4gICAgICAgIGxldCBjYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHtcbiAgICAgICAgICBoYXMocHJveHlUYXJnZXQsIHByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wIGluIHRhcmdldCB8fCBwcm9wIGluIGNhY2hlO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBnZXQocHJveHlUYXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7XG4gICAgICAgICAgICBpZiAocHJvcCBpbiBjYWNoZSkge1xuICAgICAgICAgICAgICByZXR1cm4gY2FjaGVbcHJvcF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghKHByb3AgaW4gdGFyZ2V0KSkge1xuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgdmFsdWUgPSB0YXJnZXRbcHJvcF07XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbWV0aG9kIG9uIHRoZSB1bmRlcmx5aW5nIG9iamVjdC4gQ2hlY2sgaWYgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgICAvLyBhbnkgd3JhcHBpbmcuXG4gICAgICAgICAgICAgIGlmICh0eXBlb2Ygd3JhcHBlcnNbcHJvcF0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBzcGVjaWFsLWNhc2Ugd3JhcHBlciBmb3IgdGhpcyBtZXRob2QuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwTWV0aG9kKHRhcmdldCwgdGFyZ2V0W3Byb3BdLCB3cmFwcGVyc1twcm9wXSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzT3duUHJvcGVydHkobWV0YWRhdGEsIHByb3ApKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhbiBhc3luYyBtZXRob2QgdGhhdCB3ZSBoYXZlIG1ldGFkYXRhIGZvci4gQ3JlYXRlIGFcbiAgICAgICAgICAgICAgICAvLyBQcm9taXNlIHdyYXBwZXIgZm9yIGl0LlxuICAgICAgICAgICAgICAgIGxldCB3cmFwcGVyID0gd3JhcEFzeW5jRnVuY3Rpb24ocHJvcCwgbWV0YWRhdGFbcHJvcF0pO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gd3JhcE1ldGhvZCh0YXJnZXQsIHRhcmdldFtwcm9wXSwgd3JhcHBlcik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG1ldGhvZCB0aGF0IHdlIGRvbid0IGtub3cgb3IgY2FyZSBhYm91dC4gUmV0dXJuIHRoZVxuICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIG1ldGhvZCwgYm91bmQgdG8gdGhlIHVuZGVybHlpbmcgb2JqZWN0LlxuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuYmluZCh0YXJnZXQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAoaGFzT3duUHJvcGVydHkod3JhcHBlcnMsIHByb3ApIHx8IGhhc093blByb3BlcnR5KG1ldGFkYXRhLCBwcm9wKSkpIHtcbiAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhbiBvYmplY3QgdGhhdCB3ZSBuZWVkIHRvIGRvIHNvbWUgd3JhcHBpbmcgZm9yIHRoZSBjaGlsZHJlblxuICAgICAgICAgICAgICAvLyBvZi4gQ3JlYXRlIGEgc3ViLW9iamVjdCB3cmFwcGVyIGZvciBpdCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBjaGlsZFxuICAgICAgICAgICAgICAvLyBtZXRhZGF0YS5cbiAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwT2JqZWN0KHZhbHVlLCB3cmFwcGVyc1twcm9wXSwgbWV0YWRhdGFbcHJvcF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNPd25Qcm9wZXJ0eShtZXRhZGF0YSwgXCIqXCIpKSB7XG4gICAgICAgICAgICAgIC8vIFdyYXAgYWxsIHByb3BlcnRpZXMgaW4gKiBuYW1lc3BhY2UuXG4gICAgICAgICAgICAgIHZhbHVlID0gd3JhcE9iamVjdCh2YWx1ZSwgd3JhcHBlcnNbcHJvcF0sIG1ldGFkYXRhW1wiKlwiXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGRvIGFueSB3cmFwcGluZyBmb3IgdGhpcyBwcm9wZXJ0eSxcbiAgICAgICAgICAgICAgLy8gc28ganVzdCBmb3J3YXJkIGFsbCBhY2Nlc3MgdG8gdGhlIHVuZGVybHlpbmcgb2JqZWN0LlxuICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2FjaGUsIHByb3AsIHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcblxuICAgICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbcHJvcF07XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhY2hlW3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIHNldChwcm94eVRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKSB7XG4gICAgICAgICAgICBpZiAocHJvcCBpbiBjYWNoZSkge1xuICAgICAgICAgICAgICBjYWNoZVtwcm9wXSA9IHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShwcm94eVRhcmdldCwgcHJvcCwgZGVzYykge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoY2FjaGUsIHByb3AsIGRlc2MpO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBkZWxldGVQcm9wZXJ0eShwcm94eVRhcmdldCwgcHJvcCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZGVsZXRlUHJvcGVydHkoY2FjaGUsIHByb3ApO1xuICAgICAgICAgIH1cblxuICAgICAgICB9OyAvLyBQZXIgY29udHJhY3Qgb2YgdGhlIFByb3h5IEFQSSwgdGhlIFwiZ2V0XCIgcHJveHkgaGFuZGxlciBtdXN0IHJldHVybiB0aGVcbiAgICAgICAgLy8gb3JpZ2luYWwgdmFsdWUgb2YgdGhlIHRhcmdldCBpZiB0aGF0IHZhbHVlIGlzIGRlY2xhcmVkIHJlYWQtb25seSBhbmRcbiAgICAgICAgLy8gbm9uLWNvbmZpZ3VyYWJsZS4gRm9yIHRoaXMgcmVhc29uLCB3ZSBjcmVhdGUgYW4gb2JqZWN0IHdpdGggdGhlXG4gICAgICAgIC8vIHByb3RvdHlwZSBzZXQgdG8gYHRhcmdldGAgaW5zdGVhZCBvZiB1c2luZyBgdGFyZ2V0YCBkaXJlY3RseS5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIGNhbm5vdCByZXR1cm4gYSBjdXN0b20gb2JqZWN0IGZvciBBUElzIHRoYXRcbiAgICAgICAgLy8gYXJlIGRlY2xhcmVkIHJlYWQtb25seSBhbmQgbm9uLWNvbmZpZ3VyYWJsZSwgc3VjaCBhcyBgY2hyb21lLmRldnRvb2xzYC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhlIHByb3h5IGhhbmRsZXJzIHRoZW1zZWx2ZXMgd2lsbCBzdGlsbCB1c2UgdGhlIG9yaWdpbmFsIGB0YXJnZXRgXG4gICAgICAgIC8vIGluc3RlYWQgb2YgdGhlIGBwcm94eVRhcmdldGAsIHNvIHRoYXQgdGhlIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMgYXJlXG4gICAgICAgIC8vIGRlcmVmZXJlbmNlZCB2aWEgdGhlIG9yaWdpbmFsIHRhcmdldHMuXG5cbiAgICAgICAgbGV0IHByb3h5VGFyZ2V0ID0gT2JqZWN0LmNyZWF0ZSh0YXJnZXQpO1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHByb3h5VGFyZ2V0LCBoYW5kbGVycyk7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGEgc2V0IG9mIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBhbiBldmVudCBvYmplY3QsIHdoaWNoIGhhbmRsZXNcbiAgICAgICAqIHdyYXBwaW5nIG9mIGxpc3RlbmVyIGZ1bmN0aW9ucyB0aGF0IHRob3NlIG1lc3NhZ2VzIGFyZSBwYXNzZWQuXG4gICAgICAgKlxuICAgICAgICogQSBzaW5nbGUgd3JhcHBlciBpcyBjcmVhdGVkIGZvciBlYWNoIGxpc3RlbmVyIGZ1bmN0aW9uLCBhbmQgc3RvcmVkIGluIGFcbiAgICAgICAqIG1hcC4gU3Vic2VxdWVudCBjYWxscyB0byBgYWRkTGlzdGVuZXJgLCBgaGFzTGlzdGVuZXJgLCBvciBgcmVtb3ZlTGlzdGVuZXJgXG4gICAgICAgKiByZXRyaWV2ZSB0aGUgb3JpZ2luYWwgd3JhcHBlciwgc28gdGhhdCAgYXR0ZW1wdHMgdG8gcmVtb3ZlIGFcbiAgICAgICAqIHByZXZpb3VzbHktYWRkZWQgbGlzdGVuZXIgd29yayBhcyBleHBlY3RlZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0RlZmF1bHRXZWFrTWFwPGZ1bmN0aW9uLCBmdW5jdGlvbj59IHdyYXBwZXJNYXBcbiAgICAgICAqICAgICAgICBBIERlZmF1bHRXZWFrTWFwIG9iamVjdCB3aGljaCB3aWxsIGNyZWF0ZSB0aGUgYXBwcm9wcmlhdGUgd3JhcHBlclxuICAgICAgICogICAgICAgIGZvciBhIGdpdmVuIGxpc3RlbmVyIGZ1bmN0aW9uIHdoZW4gb25lIGRvZXMgbm90IGV4aXN0LCBhbmQgcmV0cmlldmVcbiAgICAgICAqICAgICAgICBhbiBleGlzdGluZyBvbmUgd2hlbiBpdCBkb2VzLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtvYmplY3R9XG4gICAgICAgKi9cblxuXG4gICAgICBjb25zdCB3cmFwRXZlbnQgPSB3cmFwcGVyTWFwID0+ICh7XG4gICAgICAgIGFkZExpc3RlbmVyKHRhcmdldCwgbGlzdGVuZXIsIC4uLmFyZ3MpIHtcbiAgICAgICAgICB0YXJnZXQuYWRkTGlzdGVuZXIod3JhcHBlck1hcC5nZXQobGlzdGVuZXIpLCAuLi5hcmdzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBoYXNMaXN0ZW5lcih0YXJnZXQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgcmV0dXJuIHRhcmdldC5oYXNMaXN0ZW5lcih3cmFwcGVyTWFwLmdldChsaXN0ZW5lcikpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKHRhcmdldCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICB0YXJnZXQucmVtb3ZlTGlzdGVuZXIod3JhcHBlck1hcC5nZXQobGlzdGVuZXIpKTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgb25SZXF1ZXN0RmluaXNoZWRXcmFwcGVycyA9IG5ldyBEZWZhdWx0V2Vha01hcChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogV3JhcHMgYW4gb25SZXF1ZXN0RmluaXNoZWQgbGlzdGVuZXIgZnVuY3Rpb24gc28gdGhhdCBpdCB3aWxsIHJldHVybiBhXG4gICAgICAgICAqIGBnZXRDb250ZW50KClgIHByb3BlcnR5IHdoaWNoIHJldHVybnMgYSBgUHJvbWlzZWAgcmF0aGVyIHRoYW4gdXNpbmcgYVxuICAgICAgICAgKiBjYWxsYmFjayBBUEkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSByZXFcbiAgICAgICAgICogICAgICAgIFRoZSBIQVIgZW50cnkgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgbmV0d29yayByZXF1ZXN0LlxuICAgICAgICAgKi9cblxuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBvblJlcXVlc3RGaW5pc2hlZChyZXEpIHtcbiAgICAgICAgICBjb25zdCB3cmFwcGVkUmVxID0gd3JhcE9iamVjdChyZXEsIHt9XG4gICAgICAgICAgLyogd3JhcHBlcnMgKi9cbiAgICAgICAgICAsIHtcbiAgICAgICAgICAgIGdldENvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgbWluQXJnczogMCxcbiAgICAgICAgICAgICAgbWF4QXJnczogMFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGxpc3RlbmVyKHdyYXBwZWRSZXEpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBjb25zdCBvbk1lc3NhZ2VXcmFwcGVycyA9IG5ldyBEZWZhdWx0V2Vha01hcChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogV3JhcHMgYSBtZXNzYWdlIGxpc3RlbmVyIGZ1bmN0aW9uIHNvIHRoYXQgaXQgbWF5IHNlbmQgcmVzcG9uc2VzIGJhc2VkIG9uXG4gICAgICAgICAqIGl0cyByZXR1cm4gdmFsdWUsIHJhdGhlciB0aGFuIGJ5IHJldHVybmluZyBhIHNlbnRpbmVsIHZhbHVlIGFuZCBjYWxsaW5nIGFcbiAgICAgICAgICogY2FsbGJhY2suIElmIHRoZSBsaXN0ZW5lciBmdW5jdGlvbiByZXR1cm5zIGEgUHJvbWlzZSwgdGhlIHJlc3BvbnNlIGlzXG4gICAgICAgICAqIHNlbnQgd2hlbiB0aGUgcHJvbWlzZSBlaXRoZXIgcmVzb2x2ZXMgb3IgcmVqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHsqfSBtZXNzYWdlXG4gICAgICAgICAqICAgICAgICBUaGUgbWVzc2FnZSBzZW50IGJ5IHRoZSBvdGhlciBlbmQgb2YgdGhlIGNoYW5uZWwuXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzZW5kZXJcbiAgICAgICAgICogICAgICAgIERldGFpbHMgYWJvdXQgdGhlIHNlbmRlciBvZiB0aGUgbWVzc2FnZS5cbiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbigqKX0gc2VuZFJlc3BvbnNlXG4gICAgICAgICAqICAgICAgICBBIGNhbGxiYWNrIHdoaWNoLCB3aGVuIGNhbGxlZCB3aXRoIGFuIGFyYml0cmFyeSBhcmd1bWVudCwgc2VuZHNcbiAgICAgICAgICogICAgICAgIHRoYXQgdmFsdWUgYXMgYSByZXNwb25zZS5cbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqICAgICAgICBUcnVlIGlmIHRoZSB3cmFwcGVkIGxpc3RlbmVyIHJldHVybmVkIGEgUHJvbWlzZSwgd2hpY2ggd2lsbCBsYXRlclxuICAgICAgICAgKiAgICAgICAgeWllbGQgYSByZXNwb25zZS4gRmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAgICAgKi9cblxuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBvbk1lc3NhZ2UobWVzc2FnZSwgc2VuZGVyLCBzZW5kUmVzcG9uc2UpIHtcbiAgICAgICAgICBsZXQgZGlkQ2FsbFNlbmRSZXNwb25zZSA9IGZhbHNlO1xuICAgICAgICAgIGxldCB3cmFwcGVkU2VuZFJlc3BvbnNlO1xuICAgICAgICAgIGxldCBzZW5kUmVzcG9uc2VQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICB3cmFwcGVkU2VuZFJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGRpZENhbGxTZW5kUmVzcG9uc2UgPSB0cnVlO1xuICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbGV0IHJlc3VsdDtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXN1bHQgPSBsaXN0ZW5lcihtZXNzYWdlLCBzZW5kZXIsIHdyYXBwZWRTZW5kUmVzcG9uc2UpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBpc1Jlc3VsdFRoZW5hYmxlID0gcmVzdWx0ICE9PSB0cnVlICYmIGlzVGhlbmFibGUocmVzdWx0KTsgLy8gSWYgdGhlIGxpc3RlbmVyIGRpZG4ndCByZXR1cm5lZCB0cnVlIG9yIGEgUHJvbWlzZSwgb3IgY2FsbGVkXG4gICAgICAgICAgLy8gd3JhcHBlZFNlbmRSZXNwb25zZSBzeW5jaHJvbm91c2x5LCB3ZSBjYW4gZXhpdCBlYXJsaWVyXG4gICAgICAgICAgLy8gYmVjYXVzZSB0aGVyZSB3aWxsIGJlIG5vIHJlc3BvbnNlIHNlbnQgZnJvbSB0aGlzIGxpc3RlbmVyLlxuXG4gICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdHJ1ZSAmJiAhaXNSZXN1bHRUaGVuYWJsZSAmJiAhZGlkQ2FsbFNlbmRSZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0gLy8gQSBzbWFsbCBoZWxwZXIgdG8gc2VuZCB0aGUgbWVzc2FnZSBpZiB0aGUgcHJvbWlzZSByZXNvbHZlc1xuICAgICAgICAgIC8vIGFuZCBhbiBlcnJvciBpZiB0aGUgcHJvbWlzZSByZWplY3RzIChhIHdyYXBwZWQgc2VuZE1lc3NhZ2UgaGFzXG4gICAgICAgICAgLy8gdG8gdHJhbnNsYXRlIHRoZSBtZXNzYWdlIGludG8gYSByZXNvbHZlZCBwcm9taXNlIG9yIGEgcmVqZWN0ZWRcbiAgICAgICAgICAvLyBwcm9taXNlKS5cblxuXG4gICAgICAgICAgY29uc3Qgc2VuZFByb21pc2VkUmVzdWx0ID0gcHJvbWlzZSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4obXNnID0+IHtcbiAgICAgICAgICAgICAgLy8gc2VuZCB0aGUgbWVzc2FnZSB2YWx1ZS5cbiAgICAgICAgICAgICAgc2VuZFJlc3BvbnNlKG1zZyk7XG4gICAgICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgICAgIC8vIFNlbmQgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBlcnJvciBpZiB0aGUgcmVqZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgLy8gaXMgYW4gaW5zdGFuY2Ugb2YgZXJyb3IsIG9yIHRoZSBvYmplY3QgaXRzZWxmIG90aGVyd2lzZS5cbiAgICAgICAgICAgICAgbGV0IG1lc3NhZ2U7XG5cbiAgICAgICAgICAgICAgaWYgKGVycm9yICYmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yIHx8IHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSBcInN0cmluZ1wiKSkge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgX19tb3pXZWJFeHRlbnNpb25Qb2x5ZmlsbFJlamVjdF9fOiB0cnVlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAvLyBQcmludCBhbiBlcnJvciBvbiB0aGUgY29uc29sZSBpZiB1bmFibGUgdG8gc2VuZCB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2VuZCBvbk1lc3NhZ2UgcmVqZWN0ZWQgcmVwbHlcIiwgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07IC8vIElmIHRoZSBsaXN0ZW5lciByZXR1cm5lZCBhIFByb21pc2UsIHNlbmQgdGhlIHJlc29sdmVkIHZhbHVlIGFzIGFcbiAgICAgICAgICAvLyByZXN1bHQsIG90aGVyd2lzZSB3YWl0IHRoZSBwcm9taXNlIHJlbGF0ZWQgdG8gdGhlIHdyYXBwZWRTZW5kUmVzcG9uc2VcbiAgICAgICAgICAvLyBjYWxsYmFjayB0byByZXNvbHZlIGFuZCBzZW5kIGl0IGFzIGEgcmVzcG9uc2UuXG5cblxuICAgICAgICAgIGlmIChpc1Jlc3VsdFRoZW5hYmxlKSB7XG4gICAgICAgICAgICBzZW5kUHJvbWlzZWRSZXN1bHQocmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VuZFByb21pc2VkUmVzdWx0KHNlbmRSZXNwb25zZVByb21pc2UpO1xuICAgICAgICAgIH0gLy8gTGV0IENocm9tZSBrbm93IHRoYXQgdGhlIGxpc3RlbmVyIGlzIHJlcGx5aW5nLlxuXG5cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB3cmFwcGVkU2VuZE1lc3NhZ2VDYWxsYmFjayA9ICh7XG4gICAgICAgIHJlamVjdCxcbiAgICAgICAgcmVzb2x2ZVxuICAgICAgfSwgcmVwbHkpID0+IHtcbiAgICAgICAgaWYgKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAvLyBEZXRlY3Qgd2hlbiBub25lIG9mIHRoZSBsaXN0ZW5lcnMgcmVwbGllZCB0byB0aGUgc2VuZE1lc3NhZ2UgY2FsbCBhbmQgcmVzb2x2ZVxuICAgICAgICAgIC8vIHRoZSBwcm9taXNlIHRvIHVuZGVmaW5lZCBhcyBpbiBGaXJlZm94LlxuICAgICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbW96aWxsYS93ZWJleHRlbnNpb24tcG9seWZpbGwvaXNzdWVzLzEzMFxuICAgICAgICAgIGlmIChleHRlbnNpb25BUElzLnJ1bnRpbWUubGFzdEVycm9yLm1lc3NhZ2UgPT09IENIUk9NRV9TRU5EX01FU1NBR0VfQ0FMTEJBQ0tfTk9fUkVTUE9OU0VfTUVTU0FHRSkge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IubWVzc2FnZSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyZXBseSAmJiByZXBseS5fX21veldlYkV4dGVuc2lvblBvbHlmaWxsUmVqZWN0X18pIHtcbiAgICAgICAgICAvLyBDb252ZXJ0IGJhY2sgdGhlIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIGVycm9yIGludG9cbiAgICAgICAgICAvLyBhbiBFcnJvciBpbnN0YW5jZS5cbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKHJlcGx5Lm1lc3NhZ2UpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKHJlcGx5KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgd3JhcHBlZFNlbmRNZXNzYWdlID0gKG5hbWUsIG1ldGFkYXRhLCBhcGlOYW1lc3BhY2VPYmosIC4uLmFyZ3MpID0+IHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgbWV0YWRhdGEubWluQXJncykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgYXQgbGVhc3QgJHttZXRhZGF0YS5taW5BcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5taW5BcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiBtZXRhZGF0YS5tYXhBcmdzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBtb3N0ICR7bWV0YWRhdGEubWF4QXJnc30gJHtwbHVyYWxpemVBcmd1bWVudHMobWV0YWRhdGEubWF4QXJncyl9IGZvciAke25hbWV9KCksIGdvdCAke2FyZ3MubGVuZ3RofWApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICBjb25zdCB3cmFwcGVkQ2IgPSB3cmFwcGVkU2VuZE1lc3NhZ2VDYWxsYmFjay5iaW5kKG51bGwsIHtcbiAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICByZWplY3RcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhcmdzLnB1c2god3JhcHBlZENiKTtcbiAgICAgICAgICBhcGlOYW1lc3BhY2VPYmouc2VuZE1lc3NhZ2UoLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3Qgc3RhdGljV3JhcHBlcnMgPSB7XG4gICAgICAgIGRldnRvb2xzOiB7XG4gICAgICAgICAgbmV0d29yazoge1xuICAgICAgICAgICAgb25SZXF1ZXN0RmluaXNoZWQ6IHdyYXBFdmVudChvblJlcXVlc3RGaW5pc2hlZFdyYXBwZXJzKVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcnVudGltZToge1xuICAgICAgICAgIG9uTWVzc2FnZTogd3JhcEV2ZW50KG9uTWVzc2FnZVdyYXBwZXJzKSxcbiAgICAgICAgICBvbk1lc3NhZ2VFeHRlcm5hbDogd3JhcEV2ZW50KG9uTWVzc2FnZVdyYXBwZXJzKSxcbiAgICAgICAgICBzZW5kTWVzc2FnZTogd3JhcHBlZFNlbmRNZXNzYWdlLmJpbmQobnVsbCwgXCJzZW5kTWVzc2FnZVwiLCB7XG4gICAgICAgICAgICBtaW5BcmdzOiAxLFxuICAgICAgICAgICAgbWF4QXJnczogM1xuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHRhYnM6IHtcbiAgICAgICAgICBzZW5kTWVzc2FnZTogd3JhcHBlZFNlbmRNZXNzYWdlLmJpbmQobnVsbCwgXCJzZW5kTWVzc2FnZVwiLCB7XG4gICAgICAgICAgICBtaW5BcmdzOiAyLFxuICAgICAgICAgICAgbWF4QXJnczogM1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCBzZXR0aW5nTWV0YWRhdGEgPSB7XG4gICAgICAgIGNsZWFyOiB7XG4gICAgICAgICAgbWluQXJnczogMSxcbiAgICAgICAgICBtYXhBcmdzOiAxXG4gICAgICAgIH0sXG4gICAgICAgIGdldDoge1xuICAgICAgICAgIG1pbkFyZ3M6IDEsXG4gICAgICAgICAgbWF4QXJnczogMVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IHtcbiAgICAgICAgICBtaW5BcmdzOiAxLFxuICAgICAgICAgIG1heEFyZ3M6IDFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGFwaU1ldGFkYXRhLnByaXZhY3kgPSB7XG4gICAgICAgIG5ldHdvcms6IHtcbiAgICAgICAgICBcIipcIjogc2V0dGluZ01ldGFkYXRhXG4gICAgICAgIH0sXG4gICAgICAgIHNlcnZpY2VzOiB7XG4gICAgICAgICAgXCIqXCI6IHNldHRpbmdNZXRhZGF0YVxuICAgICAgICB9LFxuICAgICAgICB3ZWJzaXRlczoge1xuICAgICAgICAgIFwiKlwiOiBzZXR0aW5nTWV0YWRhdGFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiB3cmFwT2JqZWN0KGV4dGVuc2lvbkFQSXMsIHN0YXRpY1dyYXBwZXJzLCBhcGlNZXRhZGF0YSk7XG4gICAgfTsgLy8gVGhlIGJ1aWxkIHByb2Nlc3MgYWRkcyBhIFVNRCB3cmFwcGVyIGFyb3VuZCB0aGlzIGZpbGUsIHdoaWNoIG1ha2VzIHRoZVxuICAgIC8vIGBtb2R1bGVgIHZhcmlhYmxlIGF2YWlsYWJsZS5cblxuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB3cmFwQVBJcyhjaHJvbWUpO1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsVGhpcy5icm93c2VyO1xuICB9XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJyb3dzZXItcG9seWZpbGwuanMubWFwXG4iLCJpbXBvcnQge2xvb2t1cEl0ZW1zQnlJRCwgbG9va3VwSXRlbXNCeVVzZXIsIGxvb2t1cEl0ZW1zQnlMb2dnZWRJblVzZXIsIGxvb2t1cEl0ZW1zQnlMb2dnZWRJblVzZXJXaXRoQXV0aCwgZ2V0QXV0aCwgZ2V0TG9nZ2VkaW5Vc2VyLCBzdG9yZVJlZGRpdENvb2tpZXN9IGZyb20gJy4vcmVxdWVzdHMuanMnXG5pbXBvcnQge1JFTU9WRUQsIERFTEVURUQsIEFQUFJPVkVELCBMT0NLRUQsIFVOTE9DS0VELCBFRElURUQsXG4gICAgICAgIGFkZExvY2FsU3RvcmFnZUl0ZW1zLCBnZXRMb2NhbFN0b3JhZ2VJdGVtcyxcbiAgICAgICAgTUFYX1NZTkNfU1RPUkFHRV9JVEVNU19QRVJfT0JKRUNULCBNQVhfU1lOQ19TVE9SQUdFX0NIQU5HRVMsIFNFRU5fQ09VTlRfREVGQVVMVCxcbiAgICAgICAgZ2V0T2JqZWN0TmFtZXNGb3JUaGluZywgZ2V0VXNlckluaXQgfSBmcm9tICcuL3N0b3JhZ2UuanMnXG5pbXBvcnQge2NyZWF0ZU5vdGlmaWNhdGlvbiwgdXBkYXRlQmFkZ2VVbnNlZW5Db3VudCwgdHJpbURpY3RfYnlfbnVtYmVyVmFsdWVkQXR0cmlidXRlLFxuICAgICAgICBpc1VzZXJEZWxldGVkSXRlbSwgaXNSZW1vdmVkSXRlbSwgaXNDb21tZW50LFxuICAgICAgICBJdGVtRm9yU3RvcmFnZSwgTG9jYWxTdG9yYWdlSXRlbSwgQ2hhbmdlRm9yU3RvcmFnZSwgc2V0V2FybmluZ0JhZGdlfSBmcm9tICcuL2NvbW1vbi5qcydcbmltcG9ydCBicm93c2VyIGZyb20gJ3dlYmV4dGVuc2lvbi1wb2x5ZmlsbCdcblxuXG5jb25zdCBTVUJTQ1JJQkVEX0ZST01fUkVERElUID0gMFxuY29uc3QgU1VCU0NSSUJFRF9GUk9NX1JFVkVERElUID0gMVxuY29uc3QgU1VCU0NSSUJFRF9GUk9NX05BID0gMlxuXG5jb25zdCBUQVJHRVRfU0VFTl9DT1VOVF9GT1JfUFJFVklPVVNMWV9SRUNPUkRFRF9DSEFOR0UgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA2MCkrNjBcblxuZXhwb3J0IGNvbnN0IHNldEN1cnJlbnRTdGF0ZUZvcklkID0gKGlkLCBzdWJzY3JpYmVkRnJvbVVSTCkgPT4ge1xuICAgIGxldCBzdWJzY3JpYmVkRnJvbSA9IFNVQlNDUklCRURfRlJPTV9SRURESVRcbiAgICBpZiAoc3Vic2NyaWJlZEZyb21VUkwubWF0Y2goL15odHRwczpcXC9cXC93d3cucmV2ZWRkaXQuY29tLykpIHtcbiAgICAgICAgc3Vic2NyaWJlZEZyb20gPSBTVUJTQ1JJQkVEX0ZST01fUkVWRURESVRcbiAgICB9XG4gICAgcmV0dXJuIGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KG51bGwsIGZ1bmN0aW9uIChzdG9yYWdlKSB7XG4gICAgICAgIGdldEF1dGgoKVxuICAgICAgICAudGhlbigoYXV0aCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrRm9yQ2hhbmdlc190aGluZ19ieUlkKFtpZF0sICdvdGhlcicsIGZhbHNlLCBhdXRoLCBzdG9yYWdlLCBzdWJzY3JpYmVkRnJvbSwge30pXG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuY29uc3QgTUlOX1FVQVJBTlRJTkVEX0NIRUNLX0lOVEVSVkFMX0lOX1NFQ09ORFMgPSAyMCooNjAqNjAqMjQpXG5cbmV4cG9ydCBjb25zdCBjaGVja0ZvckNoYW5nZXMgPSAoKSA9PiB7XG4gICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQobnVsbCwgZnVuY3Rpb24gKHN0b3JhZ2UpIHtcbiAgICAgICAgdmFyIG90aGVyID0gT2JqZWN0LmtleXMoc3RvcmFnZS5vdGhlcl9zdWJzY3JpcHRpb25zKVxuICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkvMTAwMClcbiAgICAgICAgXG4gICAgICAgIC8vIGNoZWNrIGZvciBxdWFyYW50aW5lZCBjb250ZW50IG9uY2UgaW4gYXdoaWxlIGFuZCBlbmFibGUgbW9uaXRvcl9xdWFyYW50aW5lZCBpZiBzb21lIGlzIGZvdW5kXG4gICAgICAgIC8vIGJlY2F1c2UgdXNlcnMgbWF5IG5vdCBrbm93IHRvIGVuYWJsZSB0aGlzIG9wdGlvblxuICAgICAgICAvLyB0aGUgb3B0aW9uIGlzIG9mZiBieSBkZWZhdWx0IGJlY2F1c2UgaXQgY2FuIGFwcGVhciB0byBjYXVzZSBhbiBvY2Nhc2lvbmFsIGxvZ291dFxuICAgICAgICBpZiAoISBzdG9yYWdlLmxhc3RfY2hlY2tfcXVhcmFudGluZWRcbiAgICAgICAgICAgIHx8IChub3cgLSBzdG9yYWdlLmxhc3RfY2hlY2tfcXVhcmFudGluZWQpID4gTUlOX1FVQVJBTlRJTkVEX0NIRUNLX0lOVEVSVkFMX0lOX1NFQ09ORFMgKSB7XG4gICAgICAgICAgICBzdG9yYWdlLnRlbXBWYXJfbW9uaXRvcl9xdWFyYW50aW5lZCA9IHRydWVcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gT25seSBnZXQgT0F1dGggYXV0aCBpZiB1c2VyIGhhcyBwcm92aWRlZCBhIGN1c3RvbSBjbGllbnQgSURcbiAgICAgICAgY29uc3QgbmVlZHNPQXV0aCA9IHN0b3JhZ2Uub3B0aW9ucy5jdXN0b21fY2xpZW50aWQgJiYgc3RvcmFnZS5vcHRpb25zLmN1c3RvbV9jbGllbnRpZCAhPT0gJydcbiAgICAgICAgY29uc3QgYXV0aFByb21pc2UgPSBuZWVkc09BdXRoID8gZ2V0QXV0aChzdG9yYWdlLnRlbXBWYXJfbW9uaXRvcl9xdWFyYW50aW5lZCkgOiBQcm9taXNlLnJlc29sdmUoJ25vbmUnKVxuICAgICAgICBcbiAgICAgICAgbGV0IGNhY2hlZEF1dGhcbiAgICAgICAgYXV0aFByb21pc2UudGhlbigoYXV0aCkgPT4ge1xuICAgICAgICAgICAgY2FjaGVkQXV0aCA9IGF1dGhcbiAgICAgICAgICAgIC8vIEFsd2F5cyBjaGVjayBmb3IgbG9nZ2VkLWluIHVzZXIsIHJlZ2FyZGxlc3Mgb2Ygc3Vic2NyaXB0aW9uIHN0YXR1c1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrRm9yQ2hhbmdlc19sb2dnZWRJblVzZXIoYXV0aCwgc3RvcmFnZSlcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQWxzbyBjaGVjayBvdGhlciBzdWJzY3JpcHRpb25zIGlmIGFueSBleGlzdFxuICAgICAgICAgICAgaWYgKG90aGVyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0ZvckNoYW5nZXNfb3RoZXIoY2FjaGVkQXV0aCwgc3RvcmFnZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3U3RvcmFnZSA9IHtsYXN0X2NoZWNrOiBub3d9XG4gICAgICAgICAgICBpZiAoc3RvcmFnZS50ZW1wVmFyX21vbml0b3JfcXVhcmFudGluZWQpIHtcbiAgICAgICAgICAgICAgICBuZXdTdG9yYWdlLmxhc3RfY2hlY2tfcXVhcmFudGluZWQgPSBub3dcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdG9yYWdlLnRlbXBWYXJfcXVhcmFudGluZWRfY29udGVudF9mb3VuZCkge1xuICAgICAgICAgICAgICAgIG5ld1N0b3JhZ2Uub3B0aW9ucyA9IHN0b3JhZ2Uub3B0aW9uc1xuICAgICAgICAgICAgICAgIG5ld1N0b3JhZ2Uub3B0aW9ucy5tb25pdG9yX3F1YXJhbnRpbmVkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQobmV3U3RvcmFnZSlcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBpbiBjaGVja0ZvckNoYW5nZXM6JywgZXJyb3IpXG4gICAgICAgICAgICAvLyBDbGVhciB3YXJuaW5nIGJhZGdlIG9uIGVycm9yXG4gICAgICAgICAgICB1cGRhdGVCYWRnZVVuc2VlbkNvdW50KClcbiAgICAgICAgfSlcbiAgICB9KVxufVxuXG5jb25zdCBjaGVja0ZvckNoYW5nZXNfbG9nZ2VkSW5Vc2VyID0gYXN5bmMgKGF1dGgsIHN0b3JhZ2UpID0+IHtcbiAgICAvLyBGaXJzdCBnZXQgdGhlIGN1cnJlbnQgbG9nZ2VkLWluIHVzZXJcbiAgICByZXR1cm4gZ2V0TG9nZ2VkaW5Vc2VyKClcbiAgICAudGhlbihsb2dnZWRJblVzZXIgPT4ge1xuICAgICAgICBpZiAoIWxvZ2dlZEluVXNlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIGxvZ2dlZC1pbiB1c2VyIGZvdW5kLCBza2lwcGluZyB1c2VyIG1vbml0b3JpbmcnKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVtZW1iZXIgdGhlIGxhc3QgZGV0ZWN0ZWQgbG9nZ2VkLWluIHVzZXIgZm9yIHBvcHVwIGRpc3BsYXkgd2l0aG91dCBleHRyYSBuZXR3b3JrIGNhbGxzXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe2xhc3RfbG9nZ2VkX2luX3VzZXI6IGxvZ2dlZEluVXNlcn0pXG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIFxuICAgICAgICAvLyBBbHdheXMgbW9uaXRvciB0aGUgY3VycmVudGx5IGxvZ2dlZC1pbiB1c2VyLCByZWdhcmRsZXNzIG9mIHN1YnNjcmlwdGlvbiBzdGF0dXNcbiAgICAgICAgLy8gRW5zdXJlIHN0b3JhZ2Uga2V5cyBleGlzdCBmb3IgdGhlIGxvZ2dlZC1pbiB1c2VyXG4gICAgICAgIGNvbnN0IHVzZXJJbml0ID0gZ2V0VXNlckluaXQobG9nZ2VkSW5Vc2VyKVxuICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldChPYmplY3Qua2V5cyh1c2VySW5pdCksIChleGlzdGluZ0tleXMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGtleXNUb0NyZWF0ZSA9IHt9XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh1c2VySW5pdCkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBleGlzdGluZ0tleXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleXNUb0NyZWF0ZVtrZXldID0gdXNlckluaXRba2V5XVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoa2V5c1RvQ3JlYXRlKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoa2V5c1RvQ3JlYXRlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgLy8gVXNlIG1lc3NhZ2UgcGFzc2luZyB0byBnZXQgaXRlbXMgZnJvbSBjb250ZW50IHNjcmlwdCBjb250ZXh0XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCBhIFJlZGRpdCB0YWIgdG8gbWFrZSB0aGUgcmVxdWVzdCBmcm9tXG4gICAgICAgICAgICBjaHJvbWUudGFicy5xdWVyeSh7dXJsOiBbJyo6Ly8qLnJlZGRpdC5jb20vKiddfSwgKHRhYnMpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGFicy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHN0b3JlZCBjb29raWVzIGFzIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3VzZV9zdG9yZWRfY29va2llcycpXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgc3VwcG9ydGVkIHN1YmRvbWFpbiAod3d3LnJlZGRpdC5jb20gb3Igb2xkLnJlZGRpdC5jb20pXG4gICAgICAgICAgICAgICAgY29uc3Qgc3VwcG9ydGVkVGFicyA9IHRhYnMuZmlsdGVyKHRhYiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhvc3RuYW1lID0gbmV3IFVSTCh0YWIudXJsKS5ob3N0bmFtZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaG9zdG5hbWUgPT09ICd3d3cucmVkZGl0LmNvbScgfHwgaG9zdG5hbWUgPT09ICdvbGQucmVkZGl0LmNvbSdcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChzdXBwb3J0ZWRUYWJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTm8gc3VwcG9ydGVkIFJlZGRpdCBzdWJkb21haW5zIGZvdW5kICh3d3cucmVkZGl0LmNvbSBvciBvbGQucmVkZGl0LmNvbSknKVxuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgdG8gdXNlIHN0b3JlZCBjb29raWVzIGFzIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3VzZV9zdG9yZWRfY29va2llcycpXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIGZpcnN0IHN1cHBvcnRlZCBSZWRkaXQgdGFiXG4gICAgICAgICAgICAgICAgY29uc3QgdGFiID0gc3VwcG9ydGVkVGFic1swXVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIGNvb2tpZXMgZm9yIGZ1dHVyZSB1c2Ugd2hlbiBubyB0YWJzIGFyZSBvcGVuXG4gICAgICAgICAgICAgICAgc3RvcmVSZWRkaXRDb29raWVzKClcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjaHJvbWUudGFicy5zZW5kTWVzc2FnZSh0YWIuaWQsIHthY3Rpb246ICdnZXQtbG9nZ2VkLWluLXVzZXItaXRlbXMnfSwgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlY2VpdmluZyBlbmQgZG9lcyBub3QgZXhpc3QsIGZhbGwgYmFjayBncmFjZWZ1bGx5IGFuZCBzZXQgd2FybmluZyBiYWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNlbmRpbmcgbWVzc2FnZSB0byBjb250ZW50IHNjcmlwdDonLCBjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRXYXJuaW5nQmFkZ2UoJ25lZWRzX3VzZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgndXNlX3N0b3JlZF9jb29raWVzJylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGl0ZW1zID0+IHtcbiAgICAgICAgICAgIGlmICghIGl0ZW1zKSByZXR1cm4gLy8gaGFuZGxlIGV4cGVjdGVkIGVycm9yc1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBIYW5kbGUgc3RvcmVkIGNvb2tpZXMgY2FzZVxuICAgICAgICAgICAgaWYgKGl0ZW1zID09PSAndXNlX3N0b3JlZF9jb29raWVzJykge1xuICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmZXRjaCBpdGVtcyB1c2luZyBzdG9yZWQgY29va2llc1xuICAgICAgICAgICAgICAgIHJldHVybiBsb29rdXBJdGVtc0J5TG9nZ2VkSW5Vc2VyV2l0aEF1dGgoJycsICduZXcnLCAnJywgc3RvcmFnZS5vcHRpb25zLm1vbml0b3JfcXVhcmFudGluZWQsIHN0b3JhZ2UudGVtcFZhcl9tb25pdG9yX3F1YXJhbnRpbmVkLCBhdXRoKVxuICAgICAgICAgICAgICAgIC50aGVuKHN0b3JlZEl0ZW1zID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEgc3RvcmVkSXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3JlZCBjb29raWVzIGFsc28gZmFpbGVkIOKGkiBrZWVwIHllbGxvdyBiYWRnZSB0byBpbmRpY2F0ZSBhdHRlbnRpb24gbmVlZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRXYXJuaW5nQmFkZ2UoJ25lZWRzX3VzZXInKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC8vIGhhbmRsZSBleHBlY3RlZCBlcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gW11cbiAgICAgICAgICAgICAgICAgICAgbGV0IHF1YXJhbnRpbmVkX3N1YnJlZGRpdHMgPSBuZXcgU2V0KClcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbUxvb2t1cCA9IHt9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdG9yZWRJdGVtcy51c2VyICYmIHN0b3JlZEl0ZW1zLnVzZXIuaXRlbXMpIHsgLy8gZm9ybWF0IGZyb20gY3JlZDIucmV2ZWRkaXQuY29tXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yZWRJdGVtcyA9IHN0b3JlZEl0ZW1zLnVzZXIuaXRlbXNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdG9yZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uZGF0YSAmJiBpdGVtLmRhdGEubmFtZSkgeyAvLyBmb3JtYXQgZnJvbSByZWRkaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gaXRlbS5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMucHVzaChpdGVtLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtTG9va3VwW2l0ZW0ubmFtZV0gPSBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5xdWFyYW50aW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhcmFudGluZWRfc3VicmVkZGl0cy5hZGQoaXRlbS5zdWJyZWRkaXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZS50ZW1wVmFyX3F1YXJhbnRpbmVkX2NvbnRlbnRfZm91bmQgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVja0ZvckNoYW5nZXNfdGhpbmdfYnlJZChpZHMsIGxvZ2dlZEluVXNlciwgdHJ1ZSwgYXV0aCwgc3RvcmFnZSwgU1VCU0NSSUJFRF9GUk9NX05BLCBpdGVtTG9va3VwLCBBcnJheS5mcm9tKHF1YXJhbnRpbmVkX3N1YnJlZGRpdHMpKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBpZHMgPSBbXVxuICAgICAgICAgICAgbGV0IHF1YXJhbnRpbmVkX3N1YnJlZGRpdHMgPSBuZXcgU2V0KClcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1Mb29rdXAgPSB7fVxuICAgICAgICAgICAgaWYgKGl0ZW1zLnVzZXIgJiYgaXRlbXMudXNlci5pdGVtcykgeyAvLyBmb3JtYXQgZnJvbSBjcmVkMi5yZXZlZGRpdC5jb21cbiAgICAgICAgICAgICAgICBpdGVtcyA9IGl0ZW1zLnVzZXIuaXRlbXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uZGF0YSAmJiBpdGVtLmRhdGEubmFtZSkgeyAvLyBmb3JtYXQgZnJvbSByZWRkaXRcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW0uZGF0YVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHMucHVzaChpdGVtLm5hbWUpXG4gICAgICAgICAgICAgICAgaXRlbUxvb2t1cFtpdGVtLm5hbWVdID0gaXRlbVxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnF1YXJhbnRpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVhcmFudGluZWRfc3VicmVkZGl0cy5hZGQoaXRlbS5zdWJyZWRkaXQpXG4gICAgICAgICAgICAgICAgICAgIHN0b3JhZ2UudGVtcFZhcl9xdWFyYW50aW5lZF9jb250ZW50X2ZvdW5kID0gdHJ1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm4gY2hlY2tGb3JDaGFuZ2VzX3RoaW5nX2J5SWQoaWRzLCBsb2dnZWRJblVzZXIsIHRydWUsIGF1dGgsIHN0b3JhZ2UsIFNVQlNDUklCRURfRlJPTV9OQSwgaXRlbUxvb2t1cCwgQXJyYXkuZnJvbShxdWFyYW50aW5lZF9zdWJyZWRkaXRzKSlcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQ2xlYXIgd2FybmluZyBiYWRnZSBhbmQgZXJyb3Igc3RhdGUgaWYgd2Ugc3VjY2Vzc2Z1bGx5IHByb2Nlc3NlZCBpdGVtc1xuICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwucmVtb3ZlKCdlcnJvcl9zdGF0dXMnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdXBkYXRlQmFkZ2VVbnNlZW5Db3VudCgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGluIGNoZWNrRm9yQ2hhbmdlc19sb2dnZWRJblVzZXI6JywgZXJyb3IpXG4gICAgfSlcbn1cblxuZnVuY3Rpb24gY2hlY2tGb3JDaGFuZ2VzX290aGVyKGF1dGgsIHN0b3JhZ2UpIHtcbiAgICBjb25zdCBpZHMgPSBPYmplY3Qua2V5cyhzdG9yYWdlLm90aGVyX3N1YnNjcmlwdGlvbnMpXG4gICAgaWYgKGlkcy5sZW5ndGgpIHtcbiAgICAgICAgY2hlY2tGb3JDaGFuZ2VzX3RoaW5nX2J5SWQoaWRzLCAnb3RoZXInLCBmYWxzZSwgYXV0aCwgc3RvcmFnZSwgU1VCU0NSSUJFRF9GUk9NX05BKVxuICAgIH1cbn1cblxuY29uc3QgY2hlY2tGb3JDaGFuZ2VzX3RoaW5nX2J5SWQgPSBhc3luYyAoaWRzLCB0aGluZywgaXNVc2VyLCBhdXRoLCBzdG9yYWdlLCBzdWJzY3JpYmVkRnJvbSwgaXRlbUxvb2t1cCA9IHt9LCBxdWFyYW50aW5lZF9zdWJyZWRkaXRzID0gW10pID0+IHtcbiAgICBsZXQgcHJvbWlzZVxuICAgIGNvbnN0IG1vbml0b3JfcXVhcmFudGluZWQgPSBzdG9yYWdlLm9wdGlvbnMubW9uaXRvcl9xdWFyYW50aW5lZFxuICAgIGlmIChsb2NhdGlvbi5wcm90b2NvbC5tYXRjaCgvXmh0dHAvKSkge1xuICAgICAgICAvLyB0aGlzIGNvbmRpdGlvbiBpcyBmb3Igd2hlbiB0aGUgY29kZSBpcyBhY3RpdmF0ZWQgdmlhIGEgY29udGVudCBzY3JpcHQgKGUuZy4gdGhlIHN1YnNjcmliZSBidXR0b24pIGFuZCBicm93c2VyLmNvb2tpZXMgaXMgdW5hdmFpbGFibGVcbiAgICAgICAgcHJvbWlzZSA9IGJyb3dzZXIucnVudGltZS5zZW5kTWVzc2FnZSh7YWN0aW9uOiAnZ2V0LXJlZGRpdC1pdGVtcy1ieS1pZCcsIGlkcywgbW9uaXRvcl9xdWFyYW50aW5lZH0pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZSA9IGxvb2t1cEl0ZW1zQnlJRChpZHMsIGF1dGgsIG1vbml0b3JfcXVhcmFudGluZWQsIHN0b3JhZ2UudGVtcFZhcl9tb25pdG9yX3F1YXJhbnRpbmVkLCBxdWFyYW50aW5lZF9zdWJyZWRkaXRzKVxuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZVxuICAgIC50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgIGlmICghIHJlc3VsdCkgcmV0dXJuIC8vIGhhbmRsZSBleHBlY3RlZCBlcnJvcnNcbiAgICAgICAgY29uc3QgaXRlbXMgPSBBcnJheS5pc0FycmF5KHJlc3VsdCkgPyByZXN1bHQgOiByZXN1bHQuaXRlbXNcbiAgICAgICAgaWYgKCEgaXRlbXMpIHJldHVybiAvLyBoYW5kbGUgZXhwZWN0ZWQgZXJyb3JzIGZyb20gb2JqXG4gICAgICAgIGNvbnN0IHJlbW92YWxfc3RhdHVzID0gc3RvcmFnZS5vcHRpb25zLnJlbW92YWxfc3RhdHVzXG4gICAgICAgIGNvbnN0IGxvY2tfc3RhdHVzID0gc3RvcmFnZS5vcHRpb25zLmxvY2tfc3RhdHVzXG4gICAgICAgIGNvbnN0IHRhcmdldF9zZWVuX2NvdW50ID0gc3RvcmFnZS5vcHRpb25zLnNlZW5fY291bnQgfHwgU0VFTl9DT1VOVF9ERUZBVUxUXG4gICAgICAgIGNvbnN0IGtleXMgPSBnZXRPYmplY3ROYW1lc0ZvclRoaW5nKHRoaW5nLCBpc1VzZXIpXG5cbiAgICAgICAgY29uc3Qga25vd25fcmVtb3ZlZCA9IHN0b3JhZ2Vba2V5c1sncmVtb3ZlZCddXSB8fCB7fVxuICAgICAgICBjb25zdCBrbm93bl9hcHByb3ZlZCA9IHN0b3JhZ2Vba2V5c1snYXBwcm92ZWQnXV0gfHwge31cbiAgICAgICAgY29uc3Qga25vd25fbG9ja2VkID0gc3RvcmFnZVtrZXlzWydsb2NrZWQnXV0gfHwge31cbiAgICAgICAgY29uc3Qga25vd25fdW5sb2NrZWQgPSBzdG9yYWdlW2tleXNbJ3VubG9ja2VkJ11dIHx8IHt9XG4gICAgICAgIGNvbnN0IGNoYW5nZXMgPSBzdG9yYWdlW2tleXNbJ2NoYW5nZXMnXV0gfHwgW11cbiAgICAgICAgaWYgKCEgaXNVc2VyKSB7XG4gICAgICAgICAgICBpdGVtTG9va3VwID0ge31cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZW1vdmVkID0gW10sIGFwcHJvdmVkID0gW10sIGxvY2tlZCA9IFtdLCB1bmxvY2tlZCA9IFtdXG4gICAgICAgIGl0ZW1zLmZvckVhY2goaXRlbVdyYXAgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1XcmFwLmRhdGFcbiAgICAgICAgICAgIGlmICghIGlzVXNlcikge1xuICAgICAgICAgICAgICAgIGl0ZW1Mb29rdXBbaXRlbS5uYW1lXSA9IGl0ZW1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc1JlbW92ZWRJdGVtKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKGl0ZW0ubmFtZSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXBwcm92ZWQucHVzaChpdGVtLm5hbWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXRlbS5sb2NrZWQpIHtcbiAgICAgICAgICAgICAgICBsb2NrZWQucHVzaChpdGVtLm5hbWUpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHVubG9ja2VkLnB1c2goaXRlbS5uYW1lKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAvLyBtYXJrIGl0ZW1zIHRoYXQgZG8gbm90IGV4aXN0IGluIGFycmF5c1xuICAgICAgICAvLyBjaGFuZ2UgaGFwcGVucyBpZjpcbiAgICAgICAgLy8gICAgICB0cmFja2luZyByZW1vdmFscyAmJiBpdGVtIGlzIHJlbW92ZWRcbiAgICAgICAgLy8gICAgICB0cmFja2luZyByZW1vdmFscyAmJiBpdGVtIHdhcyBpbiByZW1vdmVkLCBub3cgaW4gYXBwcm92ZWRcbiAgICAgICAgY29uc3QgbmV3TG9jYWxTdG9yYWdlSXRlbXMgPSB7fVxuXG4gICAgICAgIGNvbnN0IGNoYW5nZVR5cGVzID0gW11cbiAgICAgICAgbGV0IG51bV9jaGFuZ2VzID0gMFxuICAgICAgICByZXR1cm4gZ2V0TG9jYWxTdG9yYWdlSXRlbXModGhpbmcsIGlzVXNlcilcbiAgICAgICAgLnRoZW4oZXhpc3RpbmdMb2NhbFN0b3JhZ2VJdGVtcyA9PiB7XG4gICAgICAgICAgICBpZiAocmVtb3ZhbF9zdGF0dXMudHJhY2spIHtcbiAgICAgICAgICAgICAgICBudW1fY2hhbmdlcyArPSBtYXJrQ2hhbmdlcyhyZW1vdmVkLCBSRU1PVkVELCAnbW9kIHJlbW92ZWQnLCBrbm93bl9yZW1vdmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcHJvdmVkLCBBUFBST1ZFRCwgJ2FwcHJvdmVkJywga25vd25fYXBwcm92ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcywgaXRlbUxvb2t1cCwgcmVtb3ZhbF9zdGF0dXMubm90aWZ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0xvY2FsU3RvcmFnZUl0ZW1zLCBjaGFuZ2VUeXBlcywgaXNVc2VyLCBzdWJzY3JpYmVkRnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW1zLCB0YXJnZXRfc2Vlbl9jb3VudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsb2NrX3N0YXR1cy50cmFjaykge1xuICAgICAgICAgICAgICAgIG51bV9jaGFuZ2VzICs9IG1hcmtDaGFuZ2VzKGxvY2tlZCwgTE9DS0VELCAnbG9ja2VkJywga25vd25fbG9ja2VkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVubG9ja2VkLCBVTkxPQ0tFRCwgJ3VubG9ja2VkJywga25vd25fdW5sb2NrZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcywgaXRlbUxvb2t1cCwgbG9ja19zdGF0dXMubm90aWZ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0xvY2FsU3RvcmFnZUl0ZW1zLCBjaGFuZ2VUeXBlcywgaXNVc2VyLCBzdWJzY3JpYmVkRnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW1zLCB0YXJnZXRfc2Vlbl9jb3VudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChudW1fY2hhbmdlcyAmJiBjaGFuZ2VUeXBlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQ3JlYXRpbmcgbm90aWZpY2F0aW9uIGZvciAke3RoaW5nfTogJHtudW1fY2hhbmdlc30gY2hhbmdlcyBvZiB0eXBlICR7Y2hhbmdlVHlwZXMuam9pbignLCAnKX1gKVxuICAgICAgICAgICAgICAgIGNyZWF0ZU5vdGlmaWNhdGlvbihcbiAgICAgICAgICAgICAgICAgICAge25vdGlmaWNhdGlvbklkOiB0aGluZyxcbiAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGluZyxcbiAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGAke251bV9jaGFuZ2VzfSBuZXcgWyR7Y2hhbmdlVHlwZXMuam9pbignLCAnKX1dIGFjdGlvbnMsIGNsaWNrIHRvIHZpZXdgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2tleXNbJ3JlbW92ZWQnXV06IHRyaW1EaWN0X2J5X251bWJlclZhbHVlZEF0dHJpYnV0ZShrbm93bl9yZW1vdmVkLCBNQVhfU1lOQ19TVE9SQUdFX0lURU1TX1BFUl9PQkpFQ1QsICdjJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2tleXNbJ2FwcHJvdmVkJ11dOiB0cmltRGljdF9ieV9udW1iZXJWYWx1ZWRBdHRyaWJ1dGUoa25vd25fYXBwcm92ZWQsIE1BWF9TWU5DX1NUT1JBR0VfSVRFTVNfUEVSX09CSkVDVCwgJ2MnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBba2V5c1snbG9ja2VkJ11dOiB0cmltRGljdF9ieV9udW1iZXJWYWx1ZWRBdHRyaWJ1dGUoa25vd25fbG9ja2VkLCBNQVhfU1lOQ19TVE9SQUdFX0lURU1TX1BFUl9PQkpFQ1QsICdjJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2tleXNbJ3VubG9ja2VkJ11dOiB0cmltRGljdF9ieV9udW1iZXJWYWx1ZWRBdHRyaWJ1dGUoa25vd25fdW5sb2NrZWQsIE1BWF9TWU5DX1NUT1JBR0VfSVRFTVNfUEVSX09CSkVDVCwgJ2MnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBba2V5c1snY2hhbmdlcyddXTogY2hhbmdlcy5zbGljZSgtTUFYX1NZTkNfU1RPUkFHRV9DSEFOR0VTKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUJhZGdlVW5zZWVuQ291bnQoKVxuICAgICAgICAgICAgICAgIHJldHVybiBhZGRMb2NhbFN0b3JhZ2VJdGVtcyhuZXdMb2NhbFN0b3JhZ2VJdGVtcywgdGhpbmcsIGlzVXNlcilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuY29uc3QgY2hhbmdlSXNQcmV2aW91c2x5UmVjb3JkZWQgPSAobmFtZSwgY2hhbmdlX3R5cGUsIGNoYW5nZXMpID0+IHtcbiAgICBmb3IgKGNvbnN0IGNoYW5nZSBvZiBjaGFuZ2VzKSB7XG4gICAgICAgIGxldCBjaGFuZ2Vfb2JqID0gY2hhbmdlXG4gICAgICAgIGlmICghIChjaGFuZ2Vfb2JqIGluc3RhbmNlb2YgQ2hhbmdlRm9yU3RvcmFnZSkpIHtcbiAgICAgICAgICAgIGNoYW5nZV9vYmogPSBuZXcgQ2hhbmdlRm9yU3RvcmFnZSh7b2JqZWN0OiBjaGFuZ2V9KVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFuZ2Vfb2JqLmdldElEKCkgPT09IG5hbWUgJiYgY2hhbmdlX3R5cGUgPT09IGNoYW5nZV9vYmouZ2V0Q2hhbmdlVHlwZUludGVybmFsKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG59XG5cblxuLy8gbmV3TG9jYWxTdG9yYWdlSXRlbXMgb3BlcmF0ZXMgYXMgYSByZXR1cm4gdmFsdWVcbmZ1bmN0aW9uIG1hcmtDaGFuZ2VzIChhbGVydF9jdXJyZW50X2xpc3QsIGFsZXJ0X3R5cGUsIGFsZXJ0X3RleHQsIGFsZXJ0X2tub3duX2hhc2gsXG4gICAgICAgICAgICAgICAgICAgICAgbm9ybWFsX2N1cnJlbnRfbGlzdCwgbm9ybWFsX3R5cGUsIG5vcm1hbF90ZXh0LCBub3JtYWxfa25vd25faGFzaCxcbiAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzLCBpdGVtTG9va3VwLCBub3RpZnksIG5ld0xvY2FsU3RvcmFnZUl0ZW1zLCBjaGFuZ2VUeXBlcyxcbiAgICAgICAgICAgICAgICAgICAgICBpc1VzZXIsIHN1YnNjcmliZWRGcm9tLCBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW1zLCB0YXJnZXRfc2Vlbl9jb3VudCkge1xuICAgIGNvbnN0IGFsZXJ0X3Vuc2Vlbl9pZHMgPSBbXSxcbiAgICAgICAgICBub3JtYWxfdW5zZWVuX2lkcyA9IFtdLFxuICAgICAgICAgIGFsZXJ0X3VzZXJEZWxldGVkX3Vuc2Vlbl9pZHMgPSBbXSxcbiAgICAgICAgICBub3cgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkvMTAwMClcblxuICAgIGFsZXJ0X2N1cnJlbnRfbGlzdC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBjb25zdCBpdGVtID0gaXRlbUxvb2t1cFtuYW1lXVxuICAgICAgICAvLyAxLiBpbiB0aGUgY2FzZSBvZiBhIG5vbi11c2VycGFnZS10cmFja2VkIChpc1VzZXI9ZmFsc2UpIHJlbW92ZWQgY29tbWVudCwgZG9uJ3Qgb3ZlcndyaXRlIGxvY2FsIHN0b3JhZ2UgYi9jXG4gICAgICAgIC8vIGlmIGl0IHdlcmUgb3ZlcndyaXR0ZW4sIGJvZHkgd291bGQgYXBwZWFyIG9uIGhpc3RvcnkgcGFnZSBhcyBbcmVtb3ZlZF1cbiAgICAgICAgLy8gMi4gaW4gdGhlIGNhc2Ugb2YgdXNlcnBhZ2UgdHJhY2tpbmcgKGlzVXNlcj10cnVlKSwgb25seSBuZWVkIHRvIHNhdmUgdGhlIHRleHQgaW4gbG9jYWwgc3RvcmFnZVxuICAgICAgICAvLyB3aGVuIHRoZXJlIGlzIGEgY2hhbmdlLiB1c2VyIHBhZ2UgbG9va3VwIChpdGVtTG9va3VwKSB3aWxsIGhhdmUgb3JpZ2luYWwgdGV4dFxuICAgICAgICBjb25zdCBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW0gPSBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW1zW25hbWVdXG4gICAgICAgIGlmICghIGlzVXNlciAmJiAhIGV4aXN0aW5nTG9jYWxTdG9yYWdlSXRlbSkge1xuICAgICAgICAgICAgbmV3TG9jYWxTdG9yYWdlSXRlbXNbbmFtZV0gPSBuZXcgTG9jYWxTdG9yYWdlSXRlbSh7aXRlbTogaXRlbSwgb2JzZXJ2ZWRfdXRjOiBub3d9KVxuICAgICAgICB9IGVsc2UgaWYgKGV4aXN0aW5nTG9jYWxTdG9yYWdlSXRlbSkge1xuICAgICAgICAgICAgLy8gcmVzZXQgc2Vlbl9jb3VudCBzbyB0aGF0IGl0ZW1zIG9ic2VydmVkIGFzIGFwcHJvdmVkL25vcm1hbCBtdXN0IGJlIGNvbnNlY3V0aXZlbHkgc2VlbiB3L3RoYXQgc3RhdGVcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSB2YXIgc2Vlbl9jb3VudCBpcyByZWFsbHkgYSAnc2VlbiBhcyBub3JtYWwnIGNvdW50LCBidXQgd2UgZG9uJ3QgbmVlZCBhbiBhbGVydF9zZWVuX2NvdW50XG4gICAgICAgICAgICBjb25zdCBuZXdMb2NhbFN0b3JhZ2VJdGVtID0gbmV3IExvY2FsU3RvcmFnZUl0ZW0oe29iamVjdDogZXhpc3RpbmdMb2NhbFN0b3JhZ2VJdGVtfSlcbiAgICAgICAgICAgIG5ld0xvY2FsU3RvcmFnZUl0ZW0ucmVzZXRTZWVuQ291bnQoKVxuICAgICAgICAgICAgbmV3TG9jYWxTdG9yYWdlSXRlbXNbbmFtZV0gPSBuZXdMb2NhbFN0b3JhZ2VJdGVtXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEgKG5hbWUgaW4gYWxlcnRfa25vd25faGFzaCkpIHtcbiAgICAgICAgICAgIC8vIG1hcmtVbnNlZW4gaXMgYWx3YXlzIHRydWUgZXhjZXB0IHdoZW4gc3Vic2NyaWJpbmcgdmlhIGEgcmVkZGl0IChub3QgcmV2ZWRkaXQpIHBhZ2UgdG8gYSBuZXcgSUQgZm9yICdvdGhlcidcbiAgICAgICAgICAgIC8vIHN1YnNjcmlwdGlvbnMuIEFzIGxvbmcgYXMgdGhlIGl0ZW0gaXMgbm90ICdyZW1vdmVkJywgdGhlIGN1cnJlbnQgc3RhdGUgaXMgc3RvcmVkIGFzICdzZWVuJyAodW5zZWVuPWZhbHNlKS5cbiAgICAgICAgICAgIC8vIEl0IGlzIGFzc3VtZWQgdGhhdCB1c2VycyBzdWJzY3JpYmluZyBmcm9tIHJldmVkZGl0IHBhZ2VzIHdpbGwgYWxyZWFkeSBoYXZlIHNlZW4gYWxsIHRoZSBjdXJyZW50IG1vZCBhY3Rpb25zLFxuICAgICAgICAgICAgLy8gYW5kIHVzZXJzIHN1YnNjcmliaW5nIGZyb20gYSByZWRkaXQgcGFnZSB3aWxsIGFscmVhZHkga25vdyBhYm91dCBsb2NrZWQgaXRlbXNcbiAgICAgICAgICAgIGxldCBtYXJrVW5zZWVuID0gdHJ1ZVxuICAgICAgICAgICAgaWYgKChzdWJzY3JpYmVkRnJvbSA9PT0gU1VCU0NSSUJFRF9GUk9NX1JFRERJVCAmJiBhbGVydF90eXBlICE9PSBSRU1PVkVEKSB8fFxuICAgICAgICAgICAgICAgICBzdWJzY3JpYmVkRnJvbSA9PT0gU1VCU0NSSUJFRF9GUk9NX1JFVkVERElUKSB7XG4gICAgICAgICAgICAgICAgbWFya1Vuc2VlbiA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbGVydF9rbm93bl9oYXNoW25hbWVdID0gbmV3IEl0ZW1Gb3JTdG9yYWdlKFxuICAgICAgICAgICAgICAgIGl0ZW0uY3JlYXRlZF91dGMsXG4gICAgICAgICAgICAgICAgbWFya1Vuc2VlbixcbiAgICAgICAgICAgICAgICAoaXNDb21tZW50KGl0ZW0ubmFtZSkgJiYgaXRlbS5saW5rX2lkKSA/IGl0ZW0ubGlua19pZCA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgZGVsZXRlIG5vcm1hbF9rbm93bl9oYXNoW25hbWVdXG4gICAgICAgICAgICBpZiAobWFya1Vuc2Vlbikge1xuICAgICAgICAgICAgICAgIGxldCBhbGVydF90eXBlX3ZhciA9IGFsZXJ0X3R5cGVcbiAgICAgICAgICAgICAgICBpZiAoaXNVc2VyRGVsZXRlZEl0ZW0oaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRfdHlwZV92YXIgPSBERUxFVEVEXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0X3VzZXJEZWxldGVkX3Vuc2Vlbl9pZHMucHVzaChuYW1lKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0X3Vuc2Vlbl9pZHMucHVzaChuYW1lKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnB1c2gobmV3IENoYW5nZUZvclN0b3JhZ2Uoe2lkOiBuYW1lLCBvYnNlcnZlZF91dGM6IG5vdywgY2hhbmdlX3R5cGU6IGFsZXJ0X3R5cGVfdmFyfSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNVc2VyKSB7XG4gICAgICAgICAgICAgICAgbmV3TG9jYWxTdG9yYWdlSXRlbXNbbmFtZV0gPSBuZXcgTG9jYWxTdG9yYWdlSXRlbSh7aXRlbTogaXRlbSwgb2JzZXJ2ZWRfdXRjOiBub3d9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICBub3JtYWxfY3VycmVudF9saXN0LmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtTG9va3VwW25hbWVdXG4gICAgICAgIC8vIHNhdmUgb3JpZ2luYWwgdGV4dCBmb3IgYWxsIG5vbi11c2VycGFnZS10cmFja2VkIGl0ZW1zIHNpbmNlIGNvbW1lbnQgdGV4dCBjYW4gZGlzYXBwZWFyXG4gICAgICAgIGlmICghIGlzVXNlciAmJiAhIGV4aXN0aW5nTG9jYWxTdG9yYWdlSXRlbXNbbmFtZV0pIHtcbiAgICAgICAgICAgIG5ld0xvY2FsU3RvcmFnZUl0ZW1zW25hbWVdID0gbmV3IExvY2FsU3RvcmFnZUl0ZW0oe2l0ZW06IGl0ZW0sIG9ic2VydmVkX3V0Yzogbm93fSlcbiAgICAgICAgfVxuICAgICAgICBpZiAobmFtZSBpbiBhbGVydF9rbm93bl9oYXNoKSB7XG4gICAgICAgICAgICBjb25zdCB0aGlzX2xvY2FsU3RvcmFnZUl0ZW0gPSBuZXcgTG9jYWxTdG9yYWdlSXRlbSh7b2JqZWN0OiBleGlzdGluZ0xvY2FsU3RvcmFnZUl0ZW1zW25hbWVdfSlcbiAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBzZWVuIGNvdW50LCBha2EgJ29ic2VydmVkIHNhbWUgc3RhdHVzJyBjb3VudFxuICAgICAgICAgICAgLy8gRG9pbmcgc28gYWxsb3dzIHNlbmRpbmcgYW4gYWxlcnQgb25seSBhZnRlciBOIHRpbWVzIGEgbmV3IHN0YXR1cyBoYXMgYmVlbiBvYnNlcnZlZC5cbiAgICAgICAgICAgIC8vIFNlZTogaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yL3JldmVkZGl0L2NvbW1lbnRzL3pjN3RjbS9yZXZlZGRpdF9zZW5kaW5nX3JlcGV0aXRpdmVfbm90aWZpY2F0aW9ucy9cbiAgICAgICAgICAgIGNvbnN0IHNlZW5fY291bnQgPSB0aGlzX2xvY2FsU3RvcmFnZUl0ZW0uaW5jcmVtZW50U2VlbkNvdW50KClcbiAgICAgICAgICAgIGlmIChzZWVuX2NvdW50ID49IHRhcmdldF9zZWVuX2NvdW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlX2lzX3ByZXZpb3VzbHlfcmVjb3JkZWQgPSBjaGFuZ2VJc1ByZXZpb3VzbHlSZWNvcmRlZChuYW1lLCBub3JtYWxfdHlwZSwgY2hhbmdlcylcbiAgICAgICAgICAgICAgICAvLyBUbyBwcmV2ZW50IHJlcGVhdCBub3RpZmljYXRpb25zLCB3aG9zZSBub24tZGV0ZXJtaW5pc3RpYyBjYXVzZSBJIGhhdmVuJ3QgeWV0IGZpZ3VyZWQgb3V0LFxuICAgICAgICAgICAgICAgIC8vIG9ubHkgbm90aWZ5IGFib3V0IHRoZSBzZWNvbmQgb2JzZXJ2ZWQgY2hhbmdlIGluIHN0YXR1cyBiYWNrIHRvICdub3JtYWwnIChhcHByb3ZlZC91bmxvY2tlZClcbiAgICAgICAgICAgICAgICAvLyBpZiBhIGhpZ2hlciB0aHJlc2hvbGQgb2YgY29uc2VjdXRpdmUgbm9ybWFsIHN0YXR1c2VzIGhhcyBiZWVuIG9ic2VydmVkXG4gICAgICAgICAgICAgICAgaWYgKCEgY2hhbmdlX2lzX3ByZXZpb3VzbHlfcmVjb3JkZWQgfHwgc2Vlbl9jb3VudCA+PSBUQVJHRVRfU0VFTl9DT1VOVF9GT1JfUFJFVklPVVNMWV9SRUNPUkRFRF9DSEFOR0UpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9ybWFsX2tub3duX2hhc2hbbmFtZV0gPSBuZXcgSXRlbUZvclN0b3JhZ2UoXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNyZWF0ZWRfdXRjLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChpc0NvbW1lbnQoaXRlbS5uYW1lKSAmJiBpdGVtLmxpbmtfaWQpID8gaXRlbS5saW5rX2lkIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFsZXJ0X2tub3duX2hhc2hbbmFtZV1cblxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzLnB1c2gobmV3IENoYW5nZUZvclN0b3JhZ2Uoe2lkOiBuYW1lLCBvYnNlcnZlZF91dGM6IG5vdywgY2hhbmdlX3R5cGU6IG5vcm1hbF90eXBlLCBzZWVuX2NvdW50fSkpXG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbF91bnNlZW5faWRzLnB1c2gobmFtZSlcblxuICAgICAgICAgICAgICAgICAgICBuZXdMb2NhbFN0b3JhZ2VJdGVtc1tuYW1lXSA9IG5ldyBMb2NhbFN0b3JhZ2VJdGVtKHtpdGVtOiBpdGVtLCBvYnNlcnZlZF91dGM6IG5vd30pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3TG9jYWxTdG9yYWdlSXRlbXNbbmFtZV0gPSB0aGlzX2xvY2FsU3RvcmFnZUl0ZW1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld0xvY2FsU3RvcmFnZUl0ZW1zW25hbWVdID0gdGhpc19sb2NhbFN0b3JhZ2VJdGVtXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBub3JtYWxfa25vd25faGFzaFtuYW1lXSA9IG5ldyBJdGVtRm9yU3RvcmFnZShcbiAgICAgICAgICAgICAgICBpdGVtLmNyZWF0ZWRfdXRjLFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIChpc0NvbW1lbnQoaXRlbS5uYW1lKSAmJiBpdGVtLmxpbmtfaWQpID8gaXRlbS5saW5rX2lkIDogdW5kZWZpbmVkXG4gICAgICAgICAgICApXG4gICAgICAgIH1cbiAgICB9KVxuICAgIGNvbnN0IG51bV9jaGFuZ2VzID0gYWxlcnRfdW5zZWVuX2lkcy5sZW5ndGggKyBub3JtYWxfdW5zZWVuX2lkcy5sZW5ndGggKyBhbGVydF91c2VyRGVsZXRlZF91bnNlZW5faWRzLmxlbmd0aFxuICAgIGlmIChub3RpZnkgJiYgbnVtX2NoYW5nZXMpIHtcbiAgICAgICAgaWYgKGFsZXJ0X3Vuc2Vlbl9pZHMubGVuZ3RoKSBjaGFuZ2VUeXBlcy5wdXNoKGFsZXJ0X3RleHQpXG4gICAgICAgIGlmIChhbGVydF91c2VyRGVsZXRlZF91bnNlZW5faWRzLmxlbmd0aCkgY2hhbmdlVHlwZXMucHVzaCgndXNlciBkZWxldGVkJylcbiAgICAgICAgaWYgKG5vcm1hbF91bnNlZW5faWRzLmxlbmd0aCkgY2hhbmdlVHlwZXMucHVzaChub3JtYWxfdGV4dClcbiAgICB9XG4gICAgcmV0dXJuIG51bV9jaGFuZ2VzXG59XG4iLCJpbXBvcnQge3N1YnNjcmliZUlkLCB1bnN1YnNjcmliZUlkLCBnZXRMb2NhbFN0b3JhZ2VJdGVtcywgc2F2ZUxvY2FsU3RvcmFnZUl0ZW1zfSBmcm9tICcuL3N0b3JhZ2UuanMnXG5pbXBvcnQge0xvY2FsU3RvcmFnZUl0ZW19IGZyb20gJy4vY29tbW9uLmpzJ1xuaW1wb3J0IHtzZXRDdXJyZW50U3RhdGVGb3JJZH0gZnJvbSAnLi9tb25pdG9yaW5nLmpzJ1xuaW1wb3J0IGJyb3dzZXIgZnJvbSAnd2ViZXh0ZW5zaW9uLXBvbHlmaWxsJ1xuXG5sZXQgVU5TVUJTQ1JJQkVfVEVYVCA9ICd1bnN1YnNjcmliZS1yZXYnXG5sZXQgU1VCU0NSSUJFX1RFWFQgPSAnc3Vic2NyaWJlLXJldidcblxuaWYgKGxvY2F0aW9uLmhvc3RuYW1lLm1hdGNoKC9yZXZlZGRpdFxcLmNvbSQvKSkge1xuICAgIFVOU1VCU0NSSUJFX1RFWFQgPSAndW5zdWJzY3JpYmUnXG4gICAgU1VCU0NSSUJFX1RFWFQgPSAnc3Vic2NyaWJlJ1xufVxuXG5leHBvcnQgY29uc3Qgc2V0VGV4dEFuZEZ1bmN0aW9uX3N1YnNjcmliZSA9IChpZCwgZWxlbWVudCwgY29tbWVudEJvZHkpID0+IHtcbiAgICByZXR1cm4gJChlbGVtZW50KS50ZXh0KFNVQlNDUklCRV9URVhUKS5vZmYoJ2NsaWNrJykuY2xpY2soKGV2ZW50T2JqKSA9PiBzdWJzY3JpYmVJZF9jaGFuZ2VUZXh0KGlkLCBldmVudE9iai50YXJnZXQsIGNvbW1lbnRCb2R5KSlcbn1cblxuZXhwb3J0IGNvbnN0IHNldFRleHRBbmRGdW5jdGlvbl91bnN1YnNjcmliZSA9IChpZCwgZWxlbWVudCwgY29tbWVudEJvZHkpID0+IHtcbiAgICByZXR1cm4gJChlbGVtZW50KS50ZXh0KFVOU1VCU0NSSUJFX1RFWFQpLm9mZignY2xpY2snKS5jbGljaygoZXZlbnRPYmopID0+IHVuc3Vic2NyaWJlSWRfY2hhbmdlVGV4dChpZCwgZXZlbnRPYmoudGFyZ2V0LCBjb21tZW50Qm9keSkpXG59XG5cbmNvbnN0IHN1YnNjcmliZUlkX2NoYW5nZVRleHQgPSAoaWQsIGVsZW1lbnQsIGNvbW1lbnRCb2R5ID0gJycpID0+IHtcbiAgICBzdWJzY3JpYmVJZChpZCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBzZXRUZXh0QW5kRnVuY3Rpb25fdW5zdWJzY3JpYmUoaWQsIGVsZW1lbnQsIGNvbW1lbnRCb2R5KVxuICAgICAgICBhd2FpdCBzZXRDdXJyZW50U3RhdGVGb3JJZChpZCwgd2luZG93LmxvY2F0aW9uLmhyZWYpXG4gICAgICAgIGlmIChjb21tZW50Qm9keSkge1xuICAgICAgICAgICAgZ2V0TG9jYWxTdG9yYWdlSXRlbXMoJ290aGVyJywgZmFsc2UpXG4gICAgICAgICAgICAudGhlbihzdG9yZWRJdGVtcyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHN0b3JlZEl0ZW1zW2lkXVxuICAgICAgICAgICAgICAgIC8vIGNvbnRlbnQgZnJvbSBwcml2YXRlIHN1YnMgd29uJ3QgYmUgc2F2ZWQgYi9jXG4gICAgICAgICAgICAgICAgLy8gbm8gaXRlbSBpcyBjcmVhdGVkIGZvciB0aGF0IChyZWRkaXQgcmV0dXJucyBubyBkYXRhIGZvclxuICAgICAgICAgICAgICAgIC8vIG5vbi1sb2dnZWQtaW4gYXV0aGVudGljYXRlZCBhcHBzKVxuICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1PYmogPSBuZXcgTG9jYWxTdG9yYWdlSXRlbSh7b2JqZWN0OiBpdGVtfSlcbiAgICAgICAgICAgICAgICAgICAgaXRlbU9iai5zZXRUZXh0KGNvbW1lbnRCb2R5KVxuICAgICAgICAgICAgICAgICAgICBzdG9yZWRJdGVtc1tpZF0gPSBpdGVtT2JqXG4gICAgICAgICAgICAgICAgICAgIHNhdmVMb2NhbFN0b3JhZ2VJdGVtcygnb3RoZXInLCBmYWxzZSwgc3RvcmVkSXRlbXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGZhbHNlXG59XG5cbmNvbnN0IHVuc3Vic2NyaWJlSWRfY2hhbmdlVGV4dCA9IChpZCwgZWxlbWVudCwgY29tbWVudEJvZHkpID0+IHtcbiAgICB1bnN1YnNjcmliZUlkKGlkLCAoKSA9PiB7XG4gICAgICAgIHNldFRleHRBbmRGdW5jdGlvbl9zdWJzY3JpYmUoaWQsIGVsZW1lbnQsIGNvbW1lbnRCb2R5KVxuICAgIH0pXG4gICAgcmV0dXJuIGZhbHNlXG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7Z2V0QXV0aCwgbG9va3VwSXRlbXNCeUlEfSBmcm9tICcuL3JlcXVlc3RzLmpzJ1xuaW1wb3J0IHtnZXRGdWxsSURzRnJvbVBhdGh9IGZyb20gJy4vY29tbW9uLmpzJ1xuaW1wb3J0IHtzZXRUZXh0QW5kRnVuY3Rpb25fc3Vic2NyaWJlLHNldFRleHRBbmRGdW5jdGlvbl91bnN1YnNjcmliZX0gZnJvbSAnLi9jb250ZW50LWNvbW1vbi5qcydcbmltcG9ydCBicm93c2VyIGZyb20gJ3dlYmV4dGVuc2lvbi1wb2x5ZmlsbCdcbmltcG9ydCB7c3Vic2NyaWJlVXNlciwgTUFYX1NVQlNDUklQVElPTlN9IGZyb20gJy4vc3RvcmFnZS5qcydcblxuY29uc3QgVVNFUl9ERUxFVEVEID0gJ3Jldi11c2VyLWRlbGV0ZWQnXG5jb25zdCBNT0RfUkVNT1ZFRCA9ICdyZXYtbW9kLXJlbW92ZWQnXG5jb25zdCBpZF9tYXRjaF9jb21tZW50ID0gL150MV8uKy9cbmNvbnN0IGlkX21hdGNoX3Bvc3QgPSAvXnQzXy4rL1xuY29uc3QgZGVmYXVsdE5ld1JlZGRpdFRhcmdldCA9ICdzaHJlZGRpdC1wb3N0J1xuXG5leHBvcnQgY29uc3QgcmVkZGl0TW9kaWZpY2F0aW9ucyA9IChvdGhlcl9zdWJzY3JpcHRpb25zLCBoaWRlX3N1YnNjcmliZSwgbW9uaXRvcl9xdWFyYW50aW5lZCwgc3Vic2NyaWJlZF91c2Vyc19sb3dlcmNhc2UsIHVuc3Vic2NyaWJlZF91c2Vyc19sb3dlcmNhc2UpID0+IHtcbiAgICBjb25zdCBpc05ld1JlZGRpdCA9IEJvb2xlYW4oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpLmdldEF0dHJpYnV0ZSgncHJlZml4JykpXG4gICAgaWZUaHJlYWRQYWdlX3Nob3dSZW1vdmFsU3RhdHVzKGlzTmV3UmVkZGl0LCBtb25pdG9yX3F1YXJhbnRpbmVkKVxuICAgIGNvbnN0IHN1YnNjcmliZUlmTm90VW5zdWJzY3JpYmVkID0gKHVzZXIpID0+IHtcbiAgICAgICAgY29uc3QgdXNlcl9sYyA9IHVzZXIudG9Mb3dlckNhc2UoKVxuICAgICAgICBpZiAoc3Vic2NyaWJlZF91c2Vyc19sb3dlcmNhc2UubGVuZ3RoIDwgTUFYX1NVQlNDUklQVElPTlMgJiZcbiAgICAgICAgICAgICEgc3Vic2NyaWJlZF91c2Vyc19sb3dlcmNhc2UuaW5jbHVkZXModXNlcl9sYykgJiZcbiAgICAgICAgICAgICEgdW5zdWJzY3JpYmVkX3VzZXJzX2xvd2VyY2FzZS5pbmNsdWRlcyh1c2VyX2xjKSkge1xuICAgICAgICAgICAgc3Vic2NyaWJlVXNlcih1c2VyKVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmICggISBpc05ld1JlZGRpdCApIHtcbiAgICAgICAgY29uc3QgdXNlcm5hbWUgPSAkKCcjaGVhZGVyIC51c2VyIGEnKVswXT8udGV4dENvbnRlbnRcbiAgICAgICAgaWYgKHVzZXJuYW1lICYmICEgdXNlcm5hbWUubWF0Y2goLyAvKSAmJiB1c2VybmFtZS50cmltKCkudG9Mb3dlckNhc2UoKSAhPT0gJ2xvZ2luJykge1xuICAgICAgICAgICAgc3Vic2NyaWJlSWZOb3RVbnN1YnNjcmliZWQodXNlcm5hbWUpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEgaGlkZV9zdWJzY3JpYmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdG9yID0gJy50aGluZy5saW5rLCAudGhpbmcuY29tbWVudCdcbiAgICAgICAgICAgIGFkZFN1YnNjcmliZUxpbmtzX29sZFJlZGRpdCgkKHNlbGVjdG9yKSwgb3RoZXJfc3Vic2NyaXB0aW9ucylcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLmFycml2ZShzZWxlY3RvciwgKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRTdWJzY3JpYmVMaW5rc19vbGRSZWRkaXQoW2VsZW1lbnRdLCBvdGhlcl9zdWJzY3JpcHRpb25zKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHVzZXJuYW1lID0gJCgnLmhlYWRlci11c2VyLWRyb3Bkb3duIHNwYW4nKS50b0FycmF5KCkubWFwKHggPT4geC50ZXh0Q29udGVudC50cmltKCkpLmZpbHRlcih4ID0+ICEgeC5tYXRjaCgvIC8pKVswXVxuICAgICAgICBpZiAodXNlcm5hbWUpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZUlmTm90VW5zdWJzY3JpYmVkKHVzZXJuYW1lKVxuICAgICAgICB9XG4gICAgICAgIGlmICghIGhpZGVfc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICBsZXQgc2VsZWN0b3JfY29tbWVudHMgPSAnLkNvbW1lbnQnXG4gICAgICAgICAgICBhZGRTdWJzY3JpYmVMaW5rc19uZXdSZWRkaXRfY29tbWVudHMoJChzZWxlY3Rvcl9jb21tZW50cyksIG90aGVyX3N1YnNjcmlwdGlvbnMpXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5hcnJpdmUoc2VsZWN0b3JfY29tbWVudHMsIChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkU3Vic2NyaWJlTGlua3NfbmV3UmVkZGl0X2NvbW1lbnRzKFtlbGVtZW50XSwgb3RoZXJfc3Vic2NyaXB0aW9ucylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rvcl9wb3N0cyA9ICcuUG9zdCdcbiAgICAgICAgICAgIGFkZFN1YnNjcmliZUxpbmtzX25ld1JlZGRpdF9wb3N0cygkKHNlbGVjdG9yX3Bvc3RzKSwgb3RoZXJfc3Vic2NyaXB0aW9ucylcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLmFycml2ZShzZWxlY3Rvcl9wb3N0cywgKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRTdWJzY3JpYmVMaW5rc19uZXdSZWRkaXRfcG9zdHMoW2VsZW1lbnRdLCBvdGhlcl9zdWJzY3JpcHRpb25zKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBhZGREaXJlY3RMaW5rc19uZXdSZWRkaXRfY29tbWVudHMoKVxuICAgICAgICBjb25zdCBzZWxlY3Rvcl9uZXdQb3N0ID0gJy5Qb3N0IGRpdltkYXRhLXRlc3QtaWQ9XCJwb3N0LWNvbnRlbnRcIl0nXG4gICAgICAgICQoZG9jdW1lbnQpLmFycml2ZShzZWxlY3Rvcl9uZXdQb3N0LCAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgc2hvd1JlbW92YWxTdGF0dXNGb3JUaHJlYWRPdmVybGF5KGVsZW1lbnQsIG1vbml0b3JfcXVhcmFudGluZWQpXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5jb25zdCByZW1vdmVkQnlNb2RlcmF0b3JUZXh0ID0gJ0NvbW1lbnQgcmVtb3ZlZCBieSBtb2RlcmF0b3InLnRvTG93ZXJDYXNlKCkudHJpbSgpXG5jb25zdCBkaXJlY3RMaW5rX2NsYXNzID0gJ1JldmVkZGl0TGluaydcbmNvbnN0IGFkZERpcmVjdExpbmtzX25ld1JlZGRpdF9jb21tZW50cyA9ICgpID0+IHtcbiAgICBjb25zdCBwcm9jZXNzTGlzdCA9IChlbGVtZW50cykgPT4ge1xuICAgICAgICBmb3IgKGNvbnN0IGVsIG9mIGVsZW1lbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9zZXN0X2Rpdl9hbmNlc3RvciA9ICQoZWwpLmNsb3Nlc3QoJ2RpdicpLmZpcnN0KClcbiAgICAgICAgICAgIGNvbnN0IHJldmVkZGl0TGluayA9ICQoY2xvc2VzdF9kaXZfYW5jZXN0b3IpLnBhcmVudCgpLmZpbmQoYC4ke2RpcmVjdExpbmtfY2xhc3N9YCkubGVuZ3RoXG4gICAgICAgICAgICBpZiAoISByZXZlZGRpdExpbmspIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWRkaXRMaW5rID0gJChjbG9zZXN0X2Rpdl9hbmNlc3RvcikuZmluZCgnYVtocmVmXj1cImh0dHBzOi8vd3d3LnJlZGRpdC5jb21cIl0nKS5maXJzdCgpLmF0dHIoJ2hyZWYnKVxuICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVkZGl0TGluaylcbiAgICAgICAgICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgndXRtX3NvdXJjZScsICdyZXZlZGRpdC1ydCcpXG4gICAgICAgICAgICAgICAgdXJsLmhvc3QgPSAnd3d3LnJldmVkZGl0LmNvbSdcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdFbCA9ICQoZWwpLmNsb25lKClcbiAgICAgICAgICAgICAgICAkKG5ld0VsKS5odG1sKGA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBzdHlsZT1cInRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1wiIGhyZWY9XCIke3VybC50b1N0cmluZygpfVwiPnZpZXcgb24gUmV2ZWRkaXQ8L2E+YClcbiAgICAgICAgICAgICAgICBjb25zdCB3cmFwID0gJChgPGRpdiBjbGFzcz1cIiR7ZGlyZWN0TGlua19jbGFzc31cIj4keyQobmV3RWwpWzBdLm91dGVySFRNTH08L2Rpdj5gKVxuICAgICAgICAgICAgICAgIHdyYXAuaW5zZXJ0QWZ0ZXIoY2xvc2VzdF9kaXZfYW5jZXN0b3IpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgJChkb2N1bWVudCkuYXJyaXZlKCdzcGFuJywgKGVsZW1lbnQpID0+IHtcbiAgICAgICAgaWYgKGVsZW1lbnQudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKS50cmltKCkgPT09IHJlbW92ZWRCeU1vZGVyYXRvclRleHQpIHtcbiAgICAgICAgICAgIHByb2Nlc3NMaXN0KFtlbGVtZW50XSlcbiAgICAgICAgfVxuICAgIH0pXG4gICAgY29uc3QgcHJvY2Vzc0NvbW1lbnRzT25QYWdlTG9hZCA9ICgpID0+IHtcbiAgICAgICAgLy8gdGhpcyBzZWxlY3RvciBpcyBub3QgYWNjZXNzaWJsZSB0byBhcnJpdmUuanNcbiAgICAgICAgcHJvY2Vzc0xpc3QoJChgc3BhbjplcXVhbHNpKFwiJHtyZW1vdmVkQnlNb2RlcmF0b3JUZXh0fVwiKWApKVxuICAgIH1cbiAgICBwcm9jZXNzQ29tbWVudHNPblBhZ2VMb2FkKClcbiAgICBzZXRUaW1lb3V0KHByb2Nlc3NDb21tZW50c09uUGFnZUxvYWQsIDEwMDApXG4gICAgc2V0VGltZW91dChwcm9jZXNzQ29tbWVudHNPblBhZ2VMb2FkLCA1MDAwKVxuICAgIHNldFRpbWVvdXQocHJvY2Vzc0NvbW1lbnRzT25QYWdlTG9hZCwgMTAwMDApXG59XG5cbmNvbnN0IGlmVGhyZWFkUGFnZV9zaG93UmVtb3ZhbFN0YXR1cyA9IChpc05ld1JlZGRpdCwgbW9uaXRvcl9xdWFyYW50aW5lZCwgbmV3UmVkZGl0VGFyZ2V0ID0gZGVmYXVsdE5ld1JlZGRpdFRhcmdldCwgcG9zdERhdGEgPSB7fSkgPT4ge1xuICAgIGNvbnN0IFtwb3N0SUQsIGNvbW1lbnRJRCwgdXNlciwgc3VicmVkZGl0XSA9IGdldEZ1bGxJRHNGcm9tUGF0aCh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUpXG4gICAgLy8gbGlua3MgdG8gY29tbWVudHMgb24gbmV3IHJlZGRpdCBkbyBub3QgaGF2ZSByb2JvdHMgbm9pbmRleCxub2ZvbGxvdywgc28gbmVlZCB0byBsb29rdXAgZGF0YSBpZiBoYXZlbid0IGFscmVhZHlcbiAgICAvLyBhcyBvZiAyMDIyLzIwMjM6IG9sZGVyIHBvc3RzIGUuZy4gdDNfOWVtemhwIG5vIGxvbmdlciBoYXZlIG5vaW5kZXgsbm9mb2xsb3csIHNvIGFsd2F5cyBuZWVkIHRvIGxvb2sgdXAgZGF0YSBmb3IgbmV3IHJlZGRpdFxuICAgIGlmIChpc05ld1JlZGRpdCAmJiBPYmplY3Qua2V5cyhwb3N0RGF0YSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGJyb3dzZXIucnVudGltZS5zZW5kTWVzc2FnZSh7YWN0aW9uOiAnZ2V0LWZyb20tb2xkJywgcGF0aDogYC9yLyR7c3VicmVkZGl0fS9jb21tZW50cy8ke3Bvc3RJRC5zdWJzdHJpbmcoMyl9L2B9KVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAoISByZXNwb25zZSkgcmV0dXJuXG4gICAgICAgICAgICBzaG93UmVtb3ZhbFN0YXR1cyh7aXNOZXdSZWRkaXQsIG5ld1JlZGRpdFRhcmdldCxcbiAgICAgICAgICAgICAgICBwb3N0RGF0YToge1xuICAgICAgICAgICAgICAgICAgICBpc19yb2JvdF9pbmRleGFibGU6ICEgcmVzcG9uc2UuaXNfcmVtb3ZlZCxcbiAgICAgICAgICAgICAgICAgICAgLi4ucmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHt9KVxuICAgICAgICAvLyBQcmV2aW91cyBjb2RlIGhlcmUgY2FsbGVkICdnZXQtcmVkZGl0LWl0ZW1zLWJ5LWlkJywgYnV0IHRoYXQgbm93IHJldHVybnMgYSA0MDNcbiAgICB9IGVsc2Uge1xuICAgICAgICBzaG93UmVtb3ZhbFN0YXR1cyh7aXNOZXdSZWRkaXQsIG5ld1JlZGRpdFRhcmdldCwgcG9zdERhdGF9KVxuICAgIH1cblxufVxuXG5jb25zdCBzaG93UmVtb3ZhbFN0YXR1cyA9ICh7aXNOZXdSZWRkaXQsIG5ld1JlZGRpdFRhcmdldCA9IGRlZmF1bHROZXdSZWRkaXRUYXJnZXQsIHBvc3REYXRhID0ge319KSA9PiB7XG4gICAgY29uc3QgW3Bvc3RJRCwgY29tbWVudElELCB1c2VyLCBzdWJyZWRkaXRdID0gZ2V0RnVsbElEc0Zyb21QYXRoKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSlcbiAgICBsZXQgY2xhc3NOYW1lID0gdW5kZWZpbmVkLCBtZXNzYWdlXzEgPSB1bmRlZmluZWRcbiAgICBpZiAocG9zdElEKSB7XG4gICAgICAgIC8vIE5vdGU6IERvIE5PVCBhZGQgdGhpcyBoZXJlOiBtZXRhW25hbWU9XCJyb2JvdHNcIl1bY29udGVudD1cIm5vaW5kZXhcIl1cbiAgICAgICAgLy8gVGhhdCBzaG93cyB1cCBvbiBhbGwgcGFnZXMgdGhhdCBhcmUgcGVybWFsaW5rcyB0byBjb21tZW50c1xuICAgICAgICBpZiAoJCgnbWV0YVtuYW1lPVwicm9ib3RzXCJdW2NvbnRlbnQ9XCJub2luZGV4LG5vZm9sbG93XCJdJykubGVuZ3RoIHx8XG4gICAgICAgICAgICAoJ2lzX3JvYm90X2luZGV4YWJsZScgaW4gcG9zdERhdGEgJiYgISBwb3N0RGF0YS5pc19yb2JvdF9pbmRleGFibGUpICkge1xuICAgICAgICAgICAgY29uc3QgYXV0aG9yID0gcG9zdERhdGEuYXV0aG9yIHx8ICQoJy5saW5rIC50b3AtbWF0dGVyIC5hdXRob3InKS5maXJzdCgpLnRleHQoKSB8fCAkKCcubGluayAudG9wLW1hdHRlciAudGFnbGluZSBzcGFuOmNvbnRhaW5zKFwiW2RlbGV0ZWRdXCIpJykudGV4dCgpIHx8ICQoJy5Qb3N0IHNwYW46Y29udGFpbnMoXCJ1L1tkZWxldGVkXVwiKScpLmZpcnN0KCkudGV4dCgpIHx8ICQoJ3NwYW5bc2xvdD1cImF1dGhvck5hbWVcIl0nKS5maXJzdCgpLnRleHQoKS50cmltKClcbiAgICAgICAgICAgIGlmICgoYXV0aG9yID09PSAnW2RlbGV0ZWRdJyB8fCBhdXRob3IgPT09ICd1L1tkZWxldGVkXScpICYmIHBvc3REYXRhLnJlbW92ZWRfYnlfY2F0ZWdvcnkgIT09ICdtb2RlcmF0b3InKSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gVVNFUl9ERUxFVEVEXG4gICAgICAgICAgICAgICAgbWVzc2FnZV8xID0gYFRoaXMgcG9zdCB3YXMgZWl0aGVyIGRlbGV0ZWQgYnkgdGhlIHBlcnNvbiB3aG8gcG9zdGVkIGl0LCBvciByZW1vdmVkIGJ5IGEgbW9kZXJhdG9yIGFuZCB0aGVuIGRlbGV0ZWQgYnkgdGhlIHBlcnNvbiB3aG8gcG9zdGVkIGl0LmBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gTU9EX1JFTU9WRURcbiAgICAgICAgICAgICAgICBtZXNzYWdlXzEgPSBgVGhpcyBwb3N0IGlzIHVuYXBwcm92ZWQuIEl0IGlzIGVpdGhlciB3YWl0aW5nIHRvIGJlIGFwcHJvdmVkLCBvciBpdCB3YXMgcmVtb3ZlZCBieSBzb21lb25lIG9yIHNvbWUgcm9ib3QuYFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1lc3NhZ2VfMSkge1xuICAgICAgICBjb25zdCBvcHRpb25zSUQgPSAnZ290by1vcHRpb25zLWZyb20tY29udGVudCdcbiAgICAgICAgY29uc3QgbWVzc2FnZV8yID0gYCBJdCBpcyBub3QgY3VycmVudGx5IHZpc2libGUgaW4gci8ke3N1YnJlZGRpdH0gYW5kIG1heSBub3QgYXBwZWFyIGluIHdlYiBzZWFyY2ggcmVzdWx0cy5gXG4gICAgICAgIGNvbnN0IGZyb20gPSBgPGRpdiBjbGFzcz1cInJldi1mcm9tXCI+PGEgaWQ9XCIke29wdGlvbnNJRH1cIiBocmVmPVwiI1wiPlJldmVkZGl0IFJlYWwtVGltZTwvYT4gbm90ZTwvZGl2PmBcbiAgICAgICAgY29uc3QgcG9zdF9wYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyw2KS5qb2luKCcvJylcbiAgICAgICAgY29uc3QgcmV2ZWRkaXRfbGluayA9IGA8cD48YSBocmVmPVwiaHR0cHM6Ly93d3cucmV2ZWRkaXQuY29tJHtwb3N0X3BhdGh9L1wiPlZpZXcgdGhlIHBvc3Qgb24gUmV2ZWRkaXQuY29tPC9hPjwvcD5gXG4gICAgICAgIGlmICghIGlzTmV3UmVkZGl0KSB7XG4gICAgICAgICAgICBtZXNzYWdlXzEgKz0gYCBWaWV3IHRoZSBwb3N0IDxhIGhyZWY9XCJodHRwczovL3NoLnJlZGRpdC5jb20ke3Bvc3RfcGF0aH0vXCI+b24gbmV3IFwic2hcIiByZWRkaXQ8L2E+IGZvciBtb3JlIGRldGFpbHMuYFxuICAgICAgICAgICAgY29uc3QgJGh0bWxfbWVzc2FnZSA9ICQoYDxkaXYgY2xhc3M9XCJyZWRkaXQtaW5mb2JhciBtZC1jb250YWluZXItc21hbGwgJHtjbGFzc05hbWV9XCI+YClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKGZyb20pXG4gICAgICAgICAgICAgICAgLmFwcGVuZChgPGRpdiBjbGFzcz1cIm1kXCI+PHA+JHttZXNzYWdlXzF9JHttZXNzYWdlXzJ9PC9wPiR7cmV2ZWRkaXRfbGlua308L2Rpdj5gKVxuICAgICAgICAgICAgJGh0bWxfbWVzc2FnZS5wcmVwZW5kVG8oJ2Rpdi5jb250ZW50W3JvbGU9XCJtYWluXCJdJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lc3NhZ2VfMSArPSBgIE1vcmUgZGV0YWlscyBtYXkgYXBwZWFyIGluIGEgbWVzc2FnZSBhYm92ZSBmcm9tIHJlZGRpdC5gXG4gICAgICAgICAgICBjb25zdCAkaHRtbF93cmFwID0gJChgPGRpdiBjbGFzcz1cInJldi1uZXctcmVkZGl0LW1lc3NhZ2Utd3JhcCAke2NsYXNzTmFtZX1cIj4ke2Zyb219PC9kaXY+YClcbiAgICAgICAgICAgIGNvbnN0ICRodG1sX2NvbnRlbnQgPSAkKGA8ZGl2IGNsYXNzPVwicmV2LW5ldy1yZWRkaXQtbWVzc2FnZS1jb250ZW50XCI+PC9kaXY+YClcbiAgICAgICAgICAgIGNvbnN0ICRodG1sX2Rlc2NyaXB0aW9uID0gJChgPGRpdiBjbGFzcz1cInJldi1uZXctcmVkZGl0LW1lc3NhZ2UtY29udGVudC1kZXNjcmlwdGlvblwiPiR7bWVzc2FnZV8xfSR7bWVzc2FnZV8yfTwvZGl2PmApXG4gICAgICAgICAgICAkaHRtbF9jb250ZW50LmFwcGVuZCgkaHRtbF9kZXNjcmlwdGlvbilcbiAgICAgICAgICAgICRodG1sX2NvbnRlbnQuYXBwZW5kKHJldmVkZGl0X2xpbmspXG4gICAgICAgICAgICAkaHRtbF93cmFwLmFwcGVuZCgkaHRtbF9jb250ZW50KVxuICAgICAgICAgICAgJChuZXdSZWRkaXRUYXJnZXQpLmZpcnN0KCkuYWZ0ZXIoJGh0bWxfd3JhcClcbiAgICAgICAgfVxuICAgICAgICAkKGAjJHtvcHRpb25zSUR9YCkuY2xpY2soKCkgPT4gYnJvd3Nlci5ydW50aW1lLnNlbmRNZXNzYWdlKHthY3Rpb246ICdvcGVuLW9wdGlvbnMnfSkpXG4gICAgfVxufVxuXG5jb25zdCBzaG93UmVtb3ZhbFN0YXR1c0ZvclRocmVhZE92ZXJsYXkgPSAoZWxlbWVudCwgbW9uaXRvcl9xdWFyYW50aW5lZCkgPT4ge1xuICAgIGNvbnN0IFtwb3N0SUQsIGNvbW1lbnRJRCwgdXNlciwgc3VicmVkZGl0XSA9IGdldEZ1bGxJRHNGcm9tUGF0aCh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUpXG4gICAgLy8gYnVpbHQgZm9yIENocm9tZSwgaS5lLiwgaW5jb2duaXRvIG1vZGUgaXMgJ3NwbGl0JyBhbmQgQ09SQiBhcHBsaWVzXG4gICAgaWYgKF9fQlVJTFRfRk9SX18gPT09ICdjaHJvbWUnKSB7XG4gICAgICAgIGJyb3dzZXIucnVudGltZS5zZW5kTWVzc2FnZSh7YWN0aW9uOiAnZ2V0LXJlZGRpdC1pdGVtcy1ieS1pZCcsIGlkczogW3Bvc3RJRF0sIG1vbml0b3JfcXVhcmFudGluZWR9KVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAoISByZXNwb25zZSB8fCAhIHJlc3BvbnNlLml0ZW1zIHx8ICEgcmVzcG9uc2UuaXRlbXMubGVuZ3RoKSByZXR1cm5cbiAgICAgICAgICAgIGNvbnN0IHBvc3REYXRhID0gcmVzcG9uc2UuaXRlbXNbMF0uZGF0YVxuICAgICAgICAgICAgaWZUaHJlYWRQYWdlX3Nob3dSZW1vdmFsU3RhdHVzKHRydWUsIG1vbml0b3JfcXVhcmFudGluZWQsIGVsZW1lbnQucGFyZW50Tm9kZSwgcG9zdERhdGEpXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7fSlcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBidWlsdCBmb3IgRmlyZWZveCwgaS5lLiwgaW5jb2duaXRvIG1vZGUgaXMgJ3NwYW5uaW5nJyBhbmQgY29udGVudCBzY3JpcHRzXG4gICAgICAgIC8vIGFyZSBhbGxvd2VkIHRvIHNlbmQgY3Jvc3Mtb3JpZ2luIHJlcXVlc3RzXG4gICAgICAgIGdldEF1dGgoKVxuICAgICAgICAudGhlbihhdXRoID0+IHtcbiAgICAgICAgICAgIHJldHVybiBsb29rdXBJdGVtc0J5SUQoW3Bvc3RJRF0sIGF1dGgsIG1vbml0b3JfcXVhcmFudGluZWQpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGl0ZW1zID0+IHtcbiAgICAgICAgICAgIC8vIGlmIHJlcXVlc3QgZmFpbHMsIGl0ZW1zIGlzIG51bGxcbiAgICAgICAgICAgIGlmICghIGl0ZW1zKSByZXR1cm5cbiAgICAgICAgICAgIGNvbnN0IHBvc3REYXRhID0gaXRlbXNbMF0uZGF0YVxuICAgICAgICAgICAgaWZUaHJlYWRQYWdlX3Nob3dSZW1vdmFsU3RhdHVzKHRydWUsIG1vbml0b3JfcXVhcmFudGluZWQsIGVsZW1lbnQucGFyZW50Tm9kZSwgcG9zdERhdGEpXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5jb25zdCBnZXRJRF9uZXdSZWRkaXQgPSAoZWxlbWVudCwgaWRfbWF0Y2gpID0+IHtcbiAgICBsZXQgaWQgPSBlbGVtZW50LmlkXG4gICAgaWYgKGlkICYmIGlkLm1hdGNoKGlkX21hdGNoKSkgcmV0dXJuIGlkXG4gICAgaWQgPSAkKGVsZW1lbnQpLmF0dHIoJ2NsYXNzJykuc3BsaXQoL1xccysvKS5maWx0ZXIoYyA9PiBjLm1hdGNoKGlkX21hdGNoKSlbMF1cbiAgICBpZiAoaWQgJiYgaWQubWF0Y2goaWRfbWF0Y2gpKSByZXR1cm4gaWRcbiAgICBpZCA9IGVsZW1lbnQucGFyZW50Tm9kZS5pZFxuICAgIGlmIChpZCAmJiBpZC5tYXRjaChpZF9tYXRjaCkpIHJldHVybiBpZFxuICAgIGlkID0gJChlbGVtZW50KS5jbG9zZXN0KCdkaXZbdGFiaW5kZXg9LTFdJykuYXR0cignaWQnKVxuICAgIHJldHVybiBpZFxufVxuXG5jb25zdCBhZGRTdWJzY3JpYmVMaW5rc19uZXdSZWRkaXRfY29tbWVudHMgPSAoZWxlbWVudHMsIHN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAkKGVsZW1lbnRzKS5lYWNoKChpZHgsIHRhcmdldGVkRWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gJCh0YXJnZXRlZEVsZW1lbnQpLmNsb3Nlc3QoJy5Db21tZW50JylbMF1cbiAgICAgICAgY29uc3QgaWQgPSBnZXRJRF9uZXdSZWRkaXQoZWxlbWVudCwgaWRfbWF0Y2hfY29tbWVudClcbiAgICAgICAgaWYgKCEgaWQgfHwgISBpZC5tYXRjaChpZF9tYXRjaF9jb21tZW50KSkgcmV0dXJuXG4gICAgICAgIGxldCAkYnV0dG9uID0gZ2V0QnV0dG9uKGVsZW1lbnQsICdzYXZlJylcbiAgICAgICAgbGV0IGFwcGVuZEJ1dHRvblRvID0gJGJ1dHRvbi5wYXJlbnQoKVxuICAgICAgICBpZiAoISAkYnV0dG9uLmxlbmd0aCkge1xuICAgICAgICAgICAgJGJ1dHRvbiA9IGdldEJ1dHRvbihlbGVtZW50LCAnc2hhcmUnKVxuICAgICAgICAgICAgYXBwZW5kQnV0dG9uVG8gPSAkYnV0dG9uLnBhcmVudCgpXG4gICAgICAgICAgICAvLyBpZiAoISAkYnV0dG9uLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gICAgICRidXR0b24gPSAkKCc8YnV0dG9uPi4uLjwvYnV0dG9uPicpXG4gICAgICAgICAgICAvLyAgICAgYXBwZW5kQnV0dG9uVG8gPSBlbGVtZW50XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgJGJ1dHRvbl9jbG9uZSA9ICRidXR0b24uY2xvbmUoKVxuICAgICAgICBsZXQgY29tbWVudEJvZHkgPSAnJ1xuICAgICAgICBjb25zdCBib2R5RWxlbWVudCA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignLlJpY2hUZXh0SlNPTi1yb290JylcbiAgICAgICAgaWYgKGJvZHlFbGVtZW50KSB7XG4gICAgICAgICAgICBjb21tZW50Qm9keSA9IGJvZHlFbGVtZW50LnRleHRDb250ZW50XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkIGluIHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgIHNldFRleHRBbmRGdW5jdGlvbl91bnN1YnNjcmliZShpZCwgJGJ1dHRvbl9jbG9uZSwgY29tbWVudEJvZHkpLmFwcGVuZFRvKGFwcGVuZEJ1dHRvblRvKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0VGV4dEFuZEZ1bmN0aW9uX3N1YnNjcmliZShpZCwgJGJ1dHRvbl9jbG9uZSwgY29tbWVudEJvZHkpLmFwcGVuZFRvKGFwcGVuZEJ1dHRvblRvKVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuY29uc3QgZ2V0QnV0dG9uID0gKGVsZW1lbnQsIGJ1dHRvbl9zZWFyY2hfdGV4dCkgPT4ge1xuICAgIHJldHVybiAkKGVsZW1lbnQpLmZpbmQoYGJ1dHRvbjplcXVhbHNpKFwiJHtidXR0b25fc2VhcmNoX3RleHR9XCIpYCkuZmlyc3QoKVxufVxuXG5jb25zdCBhZGRTdWJzY3JpYmVMaW5rc19uZXdSZWRkaXRfcG9zdHMgPSAoZWxlbWVudHMsIHN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAkKGVsZW1lbnRzKS5lYWNoKChpZHgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBnZXRJRF9uZXdSZWRkaXQoZWxlbWVudCwgaWRfbWF0Y2hfcG9zdClcbiAgICAgICAgaWYgKCEgaWQgfHwgISBpZC5tYXRjaChpZF9tYXRjaF9wb3N0KSkgcmV0dXJuXG4gICAgICAgIGNvbnN0ICRidXR0b24gPSAkKGVsZW1lbnQpLmZpbmQoJ2J1dHRvbiA6ZXF1YWxzaShcInNhdmVcIiknKS5maXJzdCgpLnBhcmVudCgpXG4gICAgICAgIGNvbnN0ICRidXR0b25fY2xvbmUgPSAkYnV0dG9uLmNsb25lKClcbiAgICAgICAgJGJ1dHRvbl9jbG9uZS5maW5kKCdpLmljb24nKS5maXJzdCgpLnBhcmVudCgpLnJlbW92ZSgpXG4gICAgICAgIGNvbnN0ICRsYXN0X2J1dHRvbiA9ICRidXR0b24ucGFyZW50KCkuY2hpbGRyZW4oJ2J1dHRvbicpLmxhc3QoKVxuICAgICAgICBpZiAoaWQgaW4gc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgc2V0VGV4dEFuZEZ1bmN0aW9uX3Vuc3Vic2NyaWJlKGlkLCAkYnV0dG9uX2Nsb25lKS5pbnNlcnRBZnRlcigkbGFzdF9idXR0b24pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUZXh0QW5kRnVuY3Rpb25fc3Vic2NyaWJlKGlkLCAkYnV0dG9uX2Nsb25lKS5pbnNlcnRBZnRlcigkbGFzdF9idXR0b24pXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5jb25zdCBhZGRTdWJzY3JpYmVMaW5rc19vbGRSZWRkaXQgPSAoZWxlbWVudHMsIHN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAkKGVsZW1lbnRzKS5lYWNoKChpZHgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgbGV0IGlkID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZnVsbG5hbWUnKVxuICAgICAgICBpZiAoISBpZCkge1xuICAgICAgICAgICAgY29uc3QgW3Bvc3RJRCwgY29tbWVudElELCB1c2VyLCBzdWJyZWRkaXRdID0gZ2V0RnVsbElEc0Zyb21QYXRoKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXBlcm1hbGluaycpIHx8ICcnKVxuICAgICAgICAgICAgaWYgKGNvbW1lbnRJRCkge1xuICAgICAgICAgICAgICAgIGlkID0gY29tbWVudElEXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBvc3RJRCkge1xuICAgICAgICAgICAgICAgIGlkID0gcG9zdElEXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEgaWQpIHJldHVyblxuICAgICAgICBjb25zdCBidXR0b25zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bC5idXR0b25zJylcbiAgICAgICAgaWYgKCEgYnV0dG9ucykgcmV0dXJuXG4gICAgICAgIGxldCBjb21tZW50Qm9keSA9ICcnXG4gICAgICAgIGNvbnN0IGJvZHlFbGVtZW50ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudXNlcnRleHQtYm9keScpXG4gICAgICAgIGlmIChib2R5RWxlbWVudCAmJiBpZC5tYXRjaCgvXnQxXy8pKSB7XG4gICAgICAgICAgICBjb21tZW50Qm9keSA9IGJvZHlFbGVtZW50LnRleHRDb250ZW50XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgJG5ld0J1dHRvbiA9IHNldFRleHRBbmRGdW5jdGlvbl9zdWJzY3JpYmUoaWQsICQoYDxhIGhyZWY9XCJcIj5gKVswXSwgY29tbWVudEJvZHkpXG4gICAgICAgIGlmIChpZCBpbiBzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgICAgICAkbmV3QnV0dG9uID0gc2V0VGV4dEFuZEZ1bmN0aW9uX3Vuc3Vic2NyaWJlKGlkLCAkKGA8YSBocmVmPVwiXCI+YClbMF0sIGNvbW1lbnRCb2R5KVxuICAgICAgICB9XG4gICAgICAgICQoYnV0dG9ucykuYXBwZW5kKCRuZXdCdXR0b24ud3JhcCgnPGxpPicpLnBhcmVudCgpKVxuICAgIH0pXG59XG4iXSwibmFtZXMiOlsiZ2xvYmFsVGhpcyIsInNlbGYiLCJtb2R1bGUiLCJjaHJvbWUiLCJydW50aW1lIiwiaWQiLCJFcnJvciIsImJyb3dzZXIiLCJPYmplY3QiLCJnZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsIkNIUk9NRV9TRU5EX01FU1NBR0VfQ0FMTEJBQ0tfTk9fUkVTUE9OU0VfTUVTU0FHRSIsIndyYXBBUElzIiwiZXh0ZW5zaW9uQVBJcyIsImFwaU1ldGFkYXRhIiwia2V5cyIsImxlbmd0aCIsIkRlZmF1bHRXZWFrTWFwIiwiV2Vha01hcCIsImNvbnN0cnVjdG9yIiwiY3JlYXRlSXRlbSIsIml0ZW1zIiwidW5kZWZpbmVkIiwic3VwZXIiLCJ0aGlzIiwiZ2V0Iiwia2V5IiwiaGFzIiwic2V0IiwiaXNUaGVuYWJsZSIsInZhbHVlIiwidGhlbiIsIm1ha2VDYWxsYmFjayIsInByb21pc2UiLCJtZXRhZGF0YSIsImNhbGxiYWNrQXJncyIsImxhc3RFcnJvciIsInJlamVjdCIsIm1lc3NhZ2UiLCJzaW5nbGVDYWxsYmFja0FyZyIsInJlc29sdmUiLCJwbHVyYWxpemVBcmd1bWVudHMiLCJudW1BcmdzIiwid3JhcEFzeW5jRnVuY3Rpb24iLCJuYW1lIiwidGFyZ2V0IiwiYXJncyIsIm1pbkFyZ3MiLCJtYXhBcmdzIiwiUHJvbWlzZSIsImZhbGxiYWNrVG9Ob0NhbGxiYWNrIiwiY2JFcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwibm9DYWxsYmFjayIsIndyYXBNZXRob2QiLCJtZXRob2QiLCJ3cmFwcGVyIiwiUHJveHkiLCJhcHBseSIsInRhcmdldE1ldGhvZCIsInRoaXNPYmoiLCJjYWxsIiwiaGFzT3duUHJvcGVydHkiLCJGdW5jdGlvbiIsImJpbmQiLCJ3cmFwT2JqZWN0Iiwid3JhcHBlcnMiLCJjYWNoZSIsImNyZWF0ZSIsImhhbmRsZXJzIiwicHJveHlUYXJnZXQiLCJwcm9wIiwicmVjZWl2ZXIiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJkZXNjIiwiUmVmbGVjdCIsImRlbGV0ZVByb3BlcnR5Iiwid3JhcEV2ZW50Iiwid3JhcHBlck1hcCIsImFkZExpc3RlbmVyIiwibGlzdGVuZXIiLCJoYXNMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwib25SZXF1ZXN0RmluaXNoZWRXcmFwcGVycyIsInJlcSIsIndyYXBwZWRSZXEiLCJnZXRDb250ZW50Iiwib25NZXNzYWdlV3JhcHBlcnMiLCJzZW5kZXIiLCJzZW5kUmVzcG9uc2UiLCJ3cmFwcGVkU2VuZFJlc3BvbnNlIiwicmVzdWx0IiwiZGlkQ2FsbFNlbmRSZXNwb25zZSIsInNlbmRSZXNwb25zZVByb21pc2UiLCJyZXNwb25zZSIsImVyciIsImlzUmVzdWx0VGhlbmFibGUiLCJzZW5kUHJvbWlzZWRSZXN1bHQiLCJtc2ciLCJlcnJvciIsIl9fbW96V2ViRXh0ZW5zaW9uUG9seWZpbGxSZWplY3RfXyIsImNhdGNoIiwid3JhcHBlZFNlbmRNZXNzYWdlQ2FsbGJhY2siLCJyZXBseSIsIndyYXBwZWRTZW5kTWVzc2FnZSIsImFwaU5hbWVzcGFjZU9iaiIsIndyYXBwZWRDYiIsInB1c2giLCJzZW5kTWVzc2FnZSIsInN0YXRpY1dyYXBwZXJzIiwiZGV2dG9vbHMiLCJuZXR3b3JrIiwib25SZXF1ZXN0RmluaXNoZWQiLCJvbk1lc3NhZ2UiLCJvbk1lc3NhZ2VFeHRlcm5hbCIsInRhYnMiLCJzZXR0aW5nTWV0YWRhdGEiLCJjbGVhciIsInByaXZhY3kiLCJzZXJ2aWNlcyIsIndlYnNpdGVzIiwiZXhwb3J0cyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJtYXRjaCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJvYmoiLCJ0b0xvd2VyQ2FzZSIsInRyaW0iXSwic291cmNlUm9vdCI6IiJ9